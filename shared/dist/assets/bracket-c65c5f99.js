import{D as mr,h as gr,j as yr,d as vr,r as _r,k as wr,l as br,w as xr,o as gn,c as Sr,b as we,m as kr,q as yn,e as Tr,s as Nr,t as Er,F as $r,_ as Ar,g as Rr,i as Mr,v as Cr}from"./installCommonHelpers-978315d6.js";import{F as Or,O as zr}from"./FittedContent-54e37ee3.js";function Ir(t,e,n){t=+t,e=+e,n=(r=arguments.length)<2?(e=t,t=0,1):r<3?1:+n;for(var i=-1,r=Math.max(0,Math.ceil((e-t)/n))|0,a=new Array(r);++i<r;)a[i]=t+i*n;return a}var Hr={value:()=>{}};function Ke(){for(var t=0,e=arguments.length,n={},i;t<e;++t){if(!(i=arguments[t]+"")||i in n||/[\s.]/.test(i))throw new Error("illegal type: "+i);n[i]=[]}return new Vt(n)}function Vt(t){this._=t}function Dr(t,e){return t.trim().split(/^|\s+/).map(function(n){var i="",r=n.indexOf(".");if(r>=0&&(i=n.slice(r+1),n=n.slice(0,r)),n&&!e.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:i}})}Vt.prototype=Ke.prototype={constructor:Vt,on:function(t,e){var n=this._,i=Dr(t+"",n),r,a=-1,s=i.length;if(arguments.length<2){for(;++a<s;)if((r=(t=i[a]).type)&&(r=Br(n[r],t.name)))return r;return}if(e!=null&&typeof e!="function")throw new Error("invalid callback: "+e);for(;++a<s;)if(r=(t=i[a]).type)n[r]=vn(n[r],t.name,e);else if(e==null)for(r in n)n[r]=vn(n[r],t.name,null);return this},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new Vt(t)},call:function(t,e){if((r=arguments.length-2)>0)for(var n=new Array(r),i=0,r,a;i<r;++i)n[i]=arguments[i+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(a=this._[t],i=0,r=a.length;i<r;++i)a[i].value.apply(e,n)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var i=this._[t],r=0,a=i.length;r<a;++r)i[r].value.apply(e,n)}};function Br(t,e){for(var n=0,i=t.length,r;n<i;++n)if((r=t[n]).name===e)return r.value}function vn(t,e,n){for(var i=0,r=t.length;i<r;++i)if(t[i].name===e){t[i]=Hr,t=t.slice(0,i).concat(t.slice(i+1));break}return n!=null&&t.push({name:e,value:n}),t}var Me="http://www.w3.org/1999/xhtml";const _n={svg:"http://www.w3.org/2000/svg",xhtml:Me,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function ce(t){var e=t+="",n=e.indexOf(":");return n>=0&&(e=t.slice(0,n))!=="xmlns"&&(t=t.slice(n+1)),_n.hasOwnProperty(e)?{space:_n[e],local:t}:t}function Lr(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===Me&&e.documentElement.namespaceURI===Me?e.createElement(t):e.createElementNS(n,t)}}function Wr(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function Qe(t){var e=ce(t);return(e.local?Wr:Lr)(e)}function Pr(){}function Je(t){return t==null?Pr:function(){return this.querySelector(t)}}function qr(t){typeof t!="function"&&(t=Je(t));for(var e=this._groups,n=e.length,i=new Array(n),r=0;r<n;++r)for(var a=e[r],s=a.length,l=i[r]=new Array(s),h,o,c=0;c<s;++c)(h=a[c])&&(o=t.call(h,h.__data__,c,a))&&("__data__"in h&&(o.__data__=h.__data__),l[c]=o);return new q(i,this._parents)}function pi(t){return t==null?[]:Array.isArray(t)?t:Array.from(t)}function Gr(){return[]}function mi(t){return t==null?Gr:function(){return this.querySelectorAll(t)}}function Ur(t){return function(){return pi(t.apply(this,arguments))}}function jr(t){typeof t=="function"?t=Ur(t):t=mi(t);for(var e=this._groups,n=e.length,i=[],r=[],a=0;a<n;++a)for(var s=e[a],l=s.length,h,o=0;o<l;++o)(h=s[o])&&(i.push(t.call(h,h.__data__,o,s)),r.push(h));return new q(i,r)}function gi(t){return function(){return this.matches(t)}}function yi(t){return function(e){return e.matches(t)}}var Fr=Array.prototype.find;function Xr(t){return function(){return Fr.call(this.children,t)}}function Vr(){return this.firstElementChild}function Yr(t){return this.select(t==null?Vr:Xr(typeof t=="function"?t:yi(t)))}var Zr=Array.prototype.filter;function Kr(){return Array.from(this.children)}function Qr(t){return function(){return Zr.call(this.children,t)}}function Jr(t){return this.selectAll(t==null?Kr:Qr(typeof t=="function"?t:yi(t)))}function ta(t){typeof t!="function"&&(t=gi(t));for(var e=this._groups,n=e.length,i=new Array(n),r=0;r<n;++r)for(var a=e[r],s=a.length,l=i[r]=[],h,o=0;o<s;++o)(h=a[o])&&t.call(h,h.__data__,o,a)&&l.push(h);return new q(i,this._parents)}function vi(t){return new Array(t.length)}function ea(){return new q(this._enter||this._groups.map(vi),this._parents)}function Jt(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}Jt.prototype={constructor:Jt,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};function na(t){return function(){return t}}function ia(t,e,n,i,r,a){for(var s=0,l,h=e.length,o=a.length;s<o;++s)(l=e[s])?(l.__data__=a[s],i[s]=l):n[s]=new Jt(t,a[s]);for(;s<h;++s)(l=e[s])&&(r[s]=l)}function ra(t,e,n,i,r,a,s){var l,h,o=new Map,c=e.length,f=a.length,u=new Array(c),p;for(l=0;l<c;++l)(h=e[l])&&(u[l]=p=s.call(h,h.__data__,l,e)+"",o.has(p)?r[l]=h:o.set(p,h));for(l=0;l<f;++l)p=s.call(t,a[l],l,a)+"",(h=o.get(p))?(i[l]=h,h.__data__=a[l],o.delete(p)):n[l]=new Jt(t,a[l]);for(l=0;l<c;++l)(h=e[l])&&o.get(u[l])===h&&(r[l]=h)}function aa(t){return t.__data__}function sa(t,e){if(!arguments.length)return Array.from(this,aa);var n=e?ra:ia,i=this._parents,r=this._groups;typeof t!="function"&&(t=na(t));for(var a=r.length,s=new Array(a),l=new Array(a),h=new Array(a),o=0;o<a;++o){var c=i[o],f=r[o],u=f.length,p=oa(t.call(c,c&&c.__data__,o,i)),y=p.length,_=l[o]=new Array(y),S=s[o]=new Array(y),v=h[o]=new Array(u);n(c,f,_,S,v,p,e);for(var k=0,O=0,M,D;k<y;++k)if(M=_[k]){for(k>=O&&(O=k+1);!(D=S[O])&&++O<y;);M._next=D||null}}return s=new q(s,i),s._enter=l,s._exit=h,s}function oa(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function la(){return new q(this._exit||this._groups.map(vi),this._parents)}function ca(t,e,n){var i=this.enter(),r=this,a=this.exit();return typeof t=="function"?(i=t(i),i&&(i=i.selection())):i=i.append(t+""),e!=null&&(r=e(r),r&&(r=r.selection())),n==null?a.remove():n(a),i&&r?i.merge(r).order():r}function ha(t){for(var e=t.selection?t.selection():t,n=this._groups,i=e._groups,r=n.length,a=i.length,s=Math.min(r,a),l=new Array(r),h=0;h<s;++h)for(var o=n[h],c=i[h],f=o.length,u=l[h]=new Array(f),p,y=0;y<f;++y)(p=o[y]||c[y])&&(u[y]=p);for(;h<r;++h)l[h]=n[h];return new q(l,this._parents)}function ua(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var i=t[e],r=i.length-1,a=i[r],s;--r>=0;)(s=i[r])&&(a&&s.compareDocumentPosition(a)^4&&a.parentNode.insertBefore(s,a),a=s);return this}function fa(t){t||(t=da);function e(f,u){return f&&u?t(f.__data__,u.__data__):!f-!u}for(var n=this._groups,i=n.length,r=new Array(i),a=0;a<i;++a){for(var s=n[a],l=s.length,h=r[a]=new Array(l),o,c=0;c<l;++c)(o=s[c])&&(h[c]=o);h.sort(e)}return new q(r,this._parents).order()}function da(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function pa(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this}function ma(){return Array.from(this)}function ga(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var i=t[e],r=0,a=i.length;r<a;++r){var s=i[r];if(s)return s}return null}function ya(){let t=0;for(const e of this)++t;return t}function va(){return!this.node()}function _a(t){for(var e=this._groups,n=0,i=e.length;n<i;++n)for(var r=e[n],a=0,s=r.length,l;a<s;++a)(l=r[a])&&t.call(l,l.__data__,a,r);return this}function wa(t){return function(){this.removeAttribute(t)}}function ba(t){return function(){this.removeAttributeNS(t.space,t.local)}}function xa(t,e){return function(){this.setAttribute(t,e)}}function Sa(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function ka(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttribute(t):this.setAttribute(t,n)}}function Ta(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function Na(t,e){var n=ce(t);if(arguments.length<2){var i=this.node();return n.local?i.getAttributeNS(n.space,n.local):i.getAttribute(n)}return this.each((e==null?n.local?ba:wa:typeof e=="function"?n.local?Ta:ka:n.local?Sa:xa)(n,e))}function _i(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function Ea(t){return function(){this.style.removeProperty(t)}}function $a(t,e,n){return function(){this.style.setProperty(t,e,n)}}function Aa(t,e,n){return function(){var i=e.apply(this,arguments);i==null?this.style.removeProperty(t):this.style.setProperty(t,i,n)}}function Ra(t,e,n){return arguments.length>1?this.each((e==null?Ea:typeof e=="function"?Aa:$a)(t,e,n??"")):wt(this.node(),t)}function wt(t,e){return t.style.getPropertyValue(e)||_i(t).getComputedStyle(t,null).getPropertyValue(e)}function Ma(t){return function(){delete this[t]}}function Ca(t,e){return function(){this[t]=e}}function Oa(t,e){return function(){var n=e.apply(this,arguments);n==null?delete this[t]:this[t]=n}}function za(t,e){return arguments.length>1?this.each((e==null?Ma:typeof e=="function"?Oa:Ca)(t,e)):this.node()[t]}function wi(t){return t.trim().split(/^|\s+/)}function tn(t){return t.classList||new bi(t)}function bi(t){this._node=t,this._names=wi(t.getAttribute("class")||"")}bi.prototype={add:function(t){var e=this._names.indexOf(t);e<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};function xi(t,e){for(var n=tn(t),i=-1,r=e.length;++i<r;)n.add(e[i])}function Si(t,e){for(var n=tn(t),i=-1,r=e.length;++i<r;)n.remove(e[i])}function Ia(t){return function(){xi(this,t)}}function Ha(t){return function(){Si(this,t)}}function Da(t,e){return function(){(e.apply(this,arguments)?xi:Si)(this,t)}}function Ba(t,e){var n=wi(t+"");if(arguments.length<2){for(var i=tn(this.node()),r=-1,a=n.length;++r<a;)if(!i.contains(n[r]))return!1;return!0}return this.each((typeof e=="function"?Da:e?Ia:Ha)(n,e))}function La(){this.textContent=""}function Wa(t){return function(){this.textContent=t}}function Pa(t){return function(){var e=t.apply(this,arguments);this.textContent=e??""}}function qa(t){return arguments.length?this.each(t==null?La:(typeof t=="function"?Pa:Wa)(t)):this.node().textContent}function Ga(){this.innerHTML=""}function Ua(t){return function(){this.innerHTML=t}}function ja(t){return function(){var e=t.apply(this,arguments);this.innerHTML=e??""}}function Fa(t){return arguments.length?this.each(t==null?Ga:(typeof t=="function"?ja:Ua)(t)):this.node().innerHTML}function Xa(){this.nextSibling&&this.parentNode.appendChild(this)}function Va(){return this.each(Xa)}function Ya(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Za(){return this.each(Ya)}function Ka(t){var e=typeof t=="function"?t:Qe(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})}function Qa(){return null}function Ja(t,e){var n=typeof t=="function"?t:Qe(t),i=e==null?Qa:typeof e=="function"?e:Je(e);return this.select(function(){return this.insertBefore(n.apply(this,arguments),i.apply(this,arguments)||null)})}function ts(){var t=this.parentNode;t&&t.removeChild(this)}function es(){return this.each(ts)}function ns(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function is(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function rs(t){return this.select(t?is:ns)}function as(t){return arguments.length?this.property("__data__",t):this.node().__data__}function ss(t){return function(e){t.call(this,e,this.__data__)}}function os(t){return t.trim().split(/^|\s+/).map(function(e){var n="",i=e.indexOf(".");return i>=0&&(n=e.slice(i+1),e=e.slice(0,i)),{type:e,name:n}})}function ls(t){return function(){var e=this.__on;if(e){for(var n=0,i=-1,r=e.length,a;n<r;++n)a=e[n],(!t.type||a.type===t.type)&&a.name===t.name?this.removeEventListener(a.type,a.listener,a.options):e[++i]=a;++i?e.length=i:delete this.__on}}}function cs(t,e,n){return function(){var i=this.__on,r,a=ss(e);if(i){for(var s=0,l=i.length;s<l;++s)if((r=i[s]).type===t.type&&r.name===t.name){this.removeEventListener(r.type,r.listener,r.options),this.addEventListener(r.type,r.listener=a,r.options=n),r.value=e;return}}this.addEventListener(t.type,a,n),r={type:t.type,name:t.name,value:e,listener:a,options:n},i?i.push(r):this.__on=[r]}}function hs(t,e,n){var i=os(t+""),r,a=i.length,s;if(arguments.length<2){var l=this.node().__on;if(l){for(var h=0,o=l.length,c;h<o;++h)for(r=0,c=l[h];r<a;++r)if((s=i[r]).type===c.type&&s.name===c.name)return c.value}return}for(l=e?cs:ls,r=0;r<a;++r)this.each(l(i[r],e,n));return this}function ki(t,e,n){var i=_i(t),r=i.CustomEvent;typeof r=="function"?r=new r(e,n):(r=i.document.createEvent("Event"),n?(r.initEvent(e,n.bubbles,n.cancelable),r.detail=n.detail):r.initEvent(e,!1,!1)),t.dispatchEvent(r)}function us(t,e){return function(){return ki(this,t,e)}}function fs(t,e){return function(){return ki(this,t,e.apply(this,arguments))}}function ds(t,e){return this.each((typeof e=="function"?fs:us)(t,e))}function*ps(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var i=t[e],r=0,a=i.length,s;r<a;++r)(s=i[r])&&(yield s)}var en=[null];function q(t,e){this._groups=t,this._parents=e}function Bt(){return new q([[document.documentElement]],en)}function ms(){return this}q.prototype=Bt.prototype={constructor:q,select:qr,selectAll:jr,selectChild:Yr,selectChildren:Jr,filter:ta,data:sa,enter:ea,exit:la,join:ca,merge:ha,selection:ms,order:ua,sort:fa,call:pa,nodes:ma,node:ga,size:ya,empty:va,each:_a,attr:Na,style:Ra,property:za,classed:Ba,text:qa,html:Fa,raise:Va,lower:Za,append:Ka,insert:Ja,remove:es,clone:rs,datum:as,on:hs,dispatch:ds,[Symbol.iterator]:ps};function H(t){return typeof t=="string"?new q([[document.querySelector(t)]],[document.documentElement]):new q([[t]],en)}function yt(t){return H(Qe(t).call(document.documentElement))}function gs(t){let e;for(;e=t.sourceEvent;)t=e;return t}function ht(t,e){if(t=gs(t),e===void 0&&(e=t.currentTarget),e){var n=e.ownerSVGElement||e;if(n.createSVGPoint){var i=n.createSVGPoint();return i.x=t.clientX,i.y=t.clientY,i=i.matrixTransform(e.getScreenCTM().inverse()),[i.x,i.y]}if(e.getBoundingClientRect){var r=e.getBoundingClientRect();return[t.clientX-r.left-e.clientLeft,t.clientY-r.top-e.clientTop]}}return[t.pageX,t.pageY]}function ys(t){return typeof t=="string"?new q([document.querySelectorAll(t)],[document.documentElement]):new q([pi(t)],en)}const Ce={capture:!0,passive:!1};function Oe(t){t.preventDefault(),t.stopImmediatePropagation()}function vs(t){var e=t.document.documentElement,n=H(t).on("dragstart.drag",Oe,Ce);"onselectstart"in e?n.on("selectstart.drag",Oe,Ce):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none")}function _s(t,e){var n=t.document.documentElement,i=H(t).on("dragstart.drag",null);e&&(i.on("click.drag",Oe,Ce),setTimeout(function(){i.on("click.drag",null)},0)),"onselectstart"in n?i.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}function nn(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function Ti(t,e){var n=Object.create(t.prototype);for(var i in e)n[i]=e[i];return n}function Lt(){}var Ot=.7,te=1/Ot,_t="\\s*([+-]?\\d+)\\s*",zt="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",K="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",ws=/^#([0-9a-f]{3,8})$/,bs=new RegExp(`^rgb\\(${_t},${_t},${_t}\\)$`),xs=new RegExp(`^rgb\\(${K},${K},${K}\\)$`),Ss=new RegExp(`^rgba\\(${_t},${_t},${_t},${zt}\\)$`),ks=new RegExp(`^rgba\\(${K},${K},${K},${zt}\\)$`),Ts=new RegExp(`^hsl\\(${zt},${K},${K}\\)$`),Ns=new RegExp(`^hsla\\(${zt},${K},${K},${zt}\\)$`),wn={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};nn(Lt,It,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:bn,formatHex:bn,formatHex8:Es,formatHsl:$s,formatRgb:xn,toString:xn});function bn(){return this.rgb().formatHex()}function Es(){return this.rgb().formatHex8()}function $s(){return Ni(this).formatHsl()}function xn(){return this.rgb().formatRgb()}function It(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=ws.exec(t))?(n=e[1].length,e=parseInt(e[1],16),n===6?Sn(e):n===3?new G(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):n===8?qt(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):n===4?qt(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=bs.exec(t))?new G(e[1],e[2],e[3],1):(e=xs.exec(t))?new G(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=Ss.exec(t))?qt(e[1],e[2],e[3],e[4]):(e=ks.exec(t))?qt(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=Ts.exec(t))?Nn(e[1],e[2]/100,e[3]/100,1):(e=Ns.exec(t))?Nn(e[1],e[2]/100,e[3]/100,e[4]):wn.hasOwnProperty(t)?Sn(wn[t]):t==="transparent"?new G(NaN,NaN,NaN,0):null}function Sn(t){return new G(t>>16&255,t>>8&255,t&255,1)}function qt(t,e,n,i){return i<=0&&(t=e=n=NaN),new G(t,e,n,i)}function As(t){return t instanceof Lt||(t=It(t)),t?(t=t.rgb(),new G(t.r,t.g,t.b,t.opacity)):new G}function ze(t,e,n,i){return arguments.length===1?As(t):new G(t,e,n,i??1)}function G(t,e,n,i){this.r=+t,this.g=+e,this.b=+n,this.opacity=+i}nn(G,ze,Ti(Lt,{brighter(t){return t=t==null?te:Math.pow(te,t),new G(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?Ot:Math.pow(Ot,t),new G(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new G(mt(this.r),mt(this.g),mt(this.b),ee(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:kn,formatHex:kn,formatHex8:Rs,formatRgb:Tn,toString:Tn}));function kn(){return`#${pt(this.r)}${pt(this.g)}${pt(this.b)}`}function Rs(){return`#${pt(this.r)}${pt(this.g)}${pt(this.b)}${pt((isNaN(this.opacity)?1:this.opacity)*255)}`}function Tn(){const t=ee(this.opacity);return`${t===1?"rgb(":"rgba("}${mt(this.r)}, ${mt(this.g)}, ${mt(this.b)}${t===1?")":`, ${t})`}`}function ee(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function mt(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function pt(t){return t=mt(t),(t<16?"0":"")+t.toString(16)}function Nn(t,e,n,i){return i<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new X(t,e,n,i)}function Ni(t){if(t instanceof X)return new X(t.h,t.s,t.l,t.opacity);if(t instanceof Lt||(t=It(t)),!t)return new X;if(t instanceof X)return t;t=t.rgb();var e=t.r/255,n=t.g/255,i=t.b/255,r=Math.min(e,n,i),a=Math.max(e,n,i),s=NaN,l=a-r,h=(a+r)/2;return l?(e===a?s=(n-i)/l+(n<i)*6:n===a?s=(i-e)/l+2:s=(e-n)/l+4,l/=h<.5?a+r:2-a-r,s*=60):l=h>0&&h<1?0:s,new X(s,l,h,t.opacity)}function Ms(t,e,n,i){return arguments.length===1?Ni(t):new X(t,e,n,i??1)}function X(t,e,n,i){this.h=+t,this.s=+e,this.l=+n,this.opacity=+i}nn(X,Ms,Ti(Lt,{brighter(t){return t=t==null?te:Math.pow(te,t),new X(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?Ot:Math.pow(Ot,t),new X(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,i=n+(n<.5?n:1-n)*e,r=2*n-i;return new G(be(t>=240?t-240:t+120,r,i),be(t,r,i),be(t<120?t+240:t-120,r,i),this.opacity)},clamp(){return new X(En(this.h),Gt(this.s),Gt(this.l),ee(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=ee(this.opacity);return`${t===1?"hsl(":"hsla("}${En(this.h)}, ${Gt(this.s)*100}%, ${Gt(this.l)*100}%${t===1?")":`, ${t})`}`}}));function En(t){return t=(t||0)%360,t<0?t+360:t}function Gt(t){return Math.max(0,Math.min(1,t||0))}function be(t,e,n){return(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)*255}const Ei=t=>()=>t;function Cs(t,e){return function(n){return t+n*e}}function Os(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(i){return Math.pow(t+i*e,n)}}function zs(t){return(t=+t)==1?$i:function(e,n){return n-e?Os(e,n,t):Ei(isNaN(e)?n:e)}}function $i(t,e){var n=e-t;return n?Cs(t,n):Ei(isNaN(t)?e:t)}const $n=function t(e){var n=zs(e);function i(r,a){var s=n((r=ze(r)).r,(a=ze(a)).r),l=n(r.g,a.g),h=n(r.b,a.b),o=$i(r.opacity,a.opacity);return function(c){return r.r=s(c),r.g=l(c),r.b=h(c),r.opacity=o(c),r+""}}return i.gamma=t,i}(1);function it(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}var Ie=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,xe=new RegExp(Ie.source,"g");function Is(t){return function(){return t}}function Hs(t){return function(e){return t(e)+""}}function Ds(t,e){var n=Ie.lastIndex=xe.lastIndex=0,i,r,a,s=-1,l=[],h=[];for(t=t+"",e=e+"";(i=Ie.exec(t))&&(r=xe.exec(e));)(a=r.index)>n&&(a=e.slice(n,a),l[s]?l[s]+=a:l[++s]=a),(i=i[0])===(r=r[0])?l[s]?l[s]+=r:l[++s]=r:(l[++s]=null,h.push({i:s,x:it(i,r)})),n=xe.lastIndex;return n<e.length&&(a=e.slice(n),l[s]?l[s]+=a:l[++s]=a),l.length<2?h[0]?Hs(h[0].x):Is(e):(e=h.length,function(o){for(var c=0,f;c<e;++c)l[(f=h[c]).i]=f.x(o);return l.join("")})}var An=180/Math.PI,He={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Ai(t,e,n,i,r,a){var s,l,h;return(s=Math.sqrt(t*t+e*e))&&(t/=s,e/=s),(h=t*n+e*i)&&(n-=t*h,i-=e*h),(l=Math.sqrt(n*n+i*i))&&(n/=l,i/=l,h/=l),t*i<e*n&&(t=-t,e=-e,h=-h,s=-s),{translateX:r,translateY:a,rotate:Math.atan2(e,t)*An,skewX:Math.atan(h)*An,scaleX:s,scaleY:l}}var Ut;function Bs(t){const e=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?He:Ai(e.a,e.b,e.c,e.d,e.e,e.f)}function Ls(t){return t==null||(Ut||(Ut=document.createElementNS("http://www.w3.org/2000/svg","g")),Ut.setAttribute("transform",t),!(t=Ut.transform.baseVal.consolidate()))?He:(t=t.matrix,Ai(t.a,t.b,t.c,t.d,t.e,t.f))}function Ri(t,e,n,i){function r(o){return o.length?o.pop()+" ":""}function a(o,c,f,u,p,y){if(o!==f||c!==u){var _=p.push("translate(",null,e,null,n);y.push({i:_-4,x:it(o,f)},{i:_-2,x:it(c,u)})}else(f||u)&&p.push("translate("+f+e+u+n)}function s(o,c,f,u){o!==c?(o-c>180?c+=360:c-o>180&&(o+=360),u.push({i:f.push(r(f)+"rotate(",null,i)-2,x:it(o,c)})):c&&f.push(r(f)+"rotate("+c+i)}function l(o,c,f,u){o!==c?u.push({i:f.push(r(f)+"skewX(",null,i)-2,x:it(o,c)}):c&&f.push(r(f)+"skewX("+c+i)}function h(o,c,f,u,p,y){if(o!==f||c!==u){var _=p.push(r(p)+"scale(",null,",",null,")");y.push({i:_-4,x:it(o,f)},{i:_-2,x:it(c,u)})}else(f!==1||u!==1)&&p.push(r(p)+"scale("+f+","+u+")")}return function(o,c){var f=[],u=[];return o=t(o),c=t(c),a(o.translateX,o.translateY,c.translateX,c.translateY,f,u),s(o.rotate,c.rotate,f,u),l(o.skewX,c.skewX,f,u),h(o.scaleX,o.scaleY,c.scaleX,c.scaleY,f,u),o=c=null,function(p){for(var y=-1,_=u.length,S;++y<_;)f[(S=u[y]).i]=S.x(p);return f.join("")}}}var Ws=Ri(Bs,"px, ","px)","deg)"),Ps=Ri(Ls,", ",")",")"),qs=1e-12;function Rn(t){return((t=Math.exp(t))+1/t)/2}function Gs(t){return((t=Math.exp(t))-1/t)/2}function Us(t){return((t=Math.exp(2*t))-1)/(t+1)}const js=function t(e,n,i){function r(a,s){var l=a[0],h=a[1],o=a[2],c=s[0],f=s[1],u=s[2],p=c-l,y=f-h,_=p*p+y*y,S,v;if(_<qs)v=Math.log(u/o)/e,S=function(w){return[l+w*p,h+w*y,o*Math.exp(e*w*v)]};else{var k=Math.sqrt(_),O=(u*u-o*o+i*_)/(2*o*n*k),M=(u*u-o*o-i*_)/(2*u*n*k),D=Math.log(Math.sqrt(O*O+1)-O),P=Math.log(Math.sqrt(M*M+1)-M);v=(P-D)/e,S=function(w){var I=w*v,T=Rn(D),N=o/(n*k)*(T*Us(e*I+D)-Gs(D));return[l+N*p,h+N*y,o*T/Rn(e*I+D)]}}return S.duration=v*1e3*e/Math.SQRT2,S}return r.rho=function(a){var s=Math.max(.001,+a),l=s*s,h=l*l;return t(s,l,h)},r}(Math.SQRT2,2,4);var bt=0,Mt=0,$t=0,Mi=1e3,ne,Ct,ie=0,vt=0,he=0,Ht=typeof performance=="object"&&performance.now?performance:Date,Ci=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function rn(){return vt||(Ci(Fs),vt=Ht.now()+he)}function Fs(){vt=0}function re(){this._call=this._time=this._next=null}re.prototype=Oi.prototype={constructor:re,restart:function(t,e,n){if(typeof t!="function")throw new TypeError("callback is not a function");n=(n==null?rn():+n)+(e==null?0:+e),!this._next&&Ct!==this&&(Ct?Ct._next=this:ne=this,Ct=this),this._call=t,this._time=n,De()},stop:function(){this._call&&(this._call=null,this._time=1/0,De())}};function Oi(t,e,n){var i=new re;return i.restart(t,e,n),i}function Xs(){rn(),++bt;for(var t=ne,e;t;)(e=vt-t._time)>=0&&t._call.call(void 0,e),t=t._next;--bt}function Mn(){vt=(ie=Ht.now())+he,bt=Mt=0;try{Xs()}finally{bt=0,Ys(),vt=0}}function Vs(){var t=Ht.now(),e=t-ie;e>Mi&&(he-=e,ie=t)}function Ys(){for(var t,e=ne,n,i=1/0;e;)e._call?(i>e._time&&(i=e._time),t=e,e=e._next):(n=e._next,e._next=null,e=t?t._next=n:ne=n);Ct=t,De(i)}function De(t){if(!bt){Mt&&(Mt=clearTimeout(Mt));var e=t-vt;e>24?(t<1/0&&(Mt=setTimeout(Mn,t-Ht.now()-he)),$t&&($t=clearInterval($t))):($t||(ie=Ht.now(),$t=setInterval(Vs,Mi)),bt=1,Ci(Mn))}}function Cn(t,e,n){var i=new re;return e=e==null?0:+e,i.restart(r=>{i.stop(),t(r+e)},e,n),i}var Zs=Ke("start","end","cancel","interrupt"),Ks=[],zi=0,On=1,Be=2,Yt=3,zn=4,Le=5,Zt=6;function ue(t,e,n,i,r,a){var s=t.__transition;if(!s)t.__transition={};else if(n in s)return;Qs(t,n,{name:e,index:i,group:r,on:Zs,tween:Ks,time:a.time,delay:a.delay,duration:a.duration,ease:a.ease,timer:null,state:zi})}function an(t,e){var n=Y(t,e);if(n.state>zi)throw new Error("too late; already scheduled");return n}function Q(t,e){var n=Y(t,e);if(n.state>Yt)throw new Error("too late; already running");return n}function Y(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}function Qs(t,e,n){var i=t.__transition,r;i[e]=n,n.timer=Oi(a,0,n.time);function a(o){n.state=On,n.timer.restart(s,n.delay,n.time),n.delay<=o&&s(o-n.delay)}function s(o){var c,f,u,p;if(n.state!==On)return h();for(c in i)if(p=i[c],p.name===n.name){if(p.state===Yt)return Cn(s);p.state===zn?(p.state=Zt,p.timer.stop(),p.on.call("interrupt",t,t.__data__,p.index,p.group),delete i[c]):+c<e&&(p.state=Zt,p.timer.stop(),p.on.call("cancel",t,t.__data__,p.index,p.group),delete i[c])}if(Cn(function(){n.state===Yt&&(n.state=zn,n.timer.restart(l,n.delay,n.time),l(o))}),n.state=Be,n.on.call("start",t,t.__data__,n.index,n.group),n.state===Be){for(n.state=Yt,r=new Array(u=n.tween.length),c=0,f=-1;c<u;++c)(p=n.tween[c].value.call(t,t.__data__,n.index,n.group))&&(r[++f]=p);r.length=f+1}}function l(o){for(var c=o<n.duration?n.ease.call(null,o/n.duration):(n.timer.restart(h),n.state=Le,1),f=-1,u=r.length;++f<u;)r[f].call(t,c);n.state===Le&&(n.on.call("end",t,t.__data__,n.index,n.group),h())}function h(){n.state=Zt,n.timer.stop(),delete i[e];for(var o in i)return;delete t.__transition}}function Kt(t,e){var n=t.__transition,i,r,a=!0,s;if(n){e=e==null?null:e+"";for(s in n){if((i=n[s]).name!==e){a=!1;continue}r=i.state>Be&&i.state<Le,i.state=Zt,i.timer.stop(),i.on.call(r?"interrupt":"cancel",t,t.__data__,i.index,i.group),delete n[s]}a&&delete t.__transition}}function Js(t){return this.each(function(){Kt(this,t)})}function to(t,e){var n,i;return function(){var r=Q(this,t),a=r.tween;if(a!==n){i=n=a;for(var s=0,l=i.length;s<l;++s)if(i[s].name===e){i=i.slice(),i.splice(s,1);break}}r.tween=i}}function eo(t,e,n){var i,r;if(typeof n!="function")throw new Error;return function(){var a=Q(this,t),s=a.tween;if(s!==i){r=(i=s).slice();for(var l={name:e,value:n},h=0,o=r.length;h<o;++h)if(r[h].name===e){r[h]=l;break}h===o&&r.push(l)}a.tween=r}}function no(t,e){var n=this._id;if(t+="",arguments.length<2){for(var i=Y(this.node(),n).tween,r=0,a=i.length,s;r<a;++r)if((s=i[r]).name===t)return s.value;return null}return this.each((e==null?to:eo)(n,t,e))}function sn(t,e,n){var i=t._id;return t.each(function(){var r=Q(this,i);(r.value||(r.value={}))[e]=n.apply(this,arguments)}),function(r){return Y(r,i).value[e]}}function Ii(t,e){var n;return(typeof e=="number"?it:e instanceof It?$n:(n=It(e))?(e=n,$n):Ds)(t,e)}function io(t){return function(){this.removeAttribute(t)}}function ro(t){return function(){this.removeAttributeNS(t.space,t.local)}}function ao(t,e,n){var i,r=n+"",a;return function(){var s=this.getAttribute(t);return s===r?null:s===i?a:a=e(i=s,n)}}function so(t,e,n){var i,r=n+"",a;return function(){var s=this.getAttributeNS(t.space,t.local);return s===r?null:s===i?a:a=e(i=s,n)}}function oo(t,e,n){var i,r,a;return function(){var s,l=n(this),h;return l==null?void this.removeAttribute(t):(s=this.getAttribute(t),h=l+"",s===h?null:s===i&&h===r?a:(r=h,a=e(i=s,l)))}}function lo(t,e,n){var i,r,a;return function(){var s,l=n(this),h;return l==null?void this.removeAttributeNS(t.space,t.local):(s=this.getAttributeNS(t.space,t.local),h=l+"",s===h?null:s===i&&h===r?a:(r=h,a=e(i=s,l)))}}function co(t,e){var n=ce(t),i=n==="transform"?Ps:Ii;return this.attrTween(t,typeof e=="function"?(n.local?lo:oo)(n,i,sn(this,"attr."+t,e)):e==null?(n.local?ro:io)(n):(n.local?so:ao)(n,i,e))}function ho(t,e){return function(n){this.setAttribute(t,e.call(this,n))}}function uo(t,e){return function(n){this.setAttributeNS(t.space,t.local,e.call(this,n))}}function fo(t,e){var n,i;function r(){var a=e.apply(this,arguments);return a!==i&&(n=(i=a)&&uo(t,a)),n}return r._value=e,r}function po(t,e){var n,i;function r(){var a=e.apply(this,arguments);return a!==i&&(n=(i=a)&&ho(t,a)),n}return r._value=e,r}function mo(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(e==null)return this.tween(n,null);if(typeof e!="function")throw new Error;var i=ce(t);return this.tween(n,(i.local?fo:po)(i,e))}function go(t,e){return function(){an(this,t).delay=+e.apply(this,arguments)}}function yo(t,e){return e=+e,function(){an(this,t).delay=e}}function vo(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?go:yo)(e,t)):Y(this.node(),e).delay}function _o(t,e){return function(){Q(this,t).duration=+e.apply(this,arguments)}}function wo(t,e){return e=+e,function(){Q(this,t).duration=e}}function bo(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?_o:wo)(e,t)):Y(this.node(),e).duration}function xo(t,e){if(typeof e!="function")throw new Error;return function(){Q(this,t).ease=e}}function So(t){var e=this._id;return arguments.length?this.each(xo(e,t)):Y(this.node(),e).ease}function ko(t,e){return function(){var n=e.apply(this,arguments);if(typeof n!="function")throw new Error;Q(this,t).ease=n}}function To(t){if(typeof t!="function")throw new Error;return this.each(ko(this._id,t))}function No(t){typeof t!="function"&&(t=gi(t));for(var e=this._groups,n=e.length,i=new Array(n),r=0;r<n;++r)for(var a=e[r],s=a.length,l=i[r]=[],h,o=0;o<s;++o)(h=a[o])&&t.call(h,h.__data__,o,a)&&l.push(h);return new st(i,this._parents,this._name,this._id)}function Eo(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,i=e.length,r=n.length,a=Math.min(i,r),s=new Array(i),l=0;l<a;++l)for(var h=e[l],o=n[l],c=h.length,f=s[l]=new Array(c),u,p=0;p<c;++p)(u=h[p]||o[p])&&(f[p]=u);for(;l<i;++l)s[l]=e[l];return new st(s,this._parents,this._name,this._id)}function $o(t){return(t+"").trim().split(/^|\s+/).every(function(e){var n=e.indexOf(".");return n>=0&&(e=e.slice(0,n)),!e||e==="start"})}function Ao(t,e,n){var i,r,a=$o(e)?an:Q;return function(){var s=a(this,t),l=s.on;l!==i&&(r=(i=l).copy()).on(e,n),s.on=r}}function Ro(t,e){var n=this._id;return arguments.length<2?Y(this.node(),n).on.on(t):this.each(Ao(n,t,e))}function Mo(t){return function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}}function Co(){return this.on("end.remove",Mo(this._id))}function Oo(t){var e=this._name,n=this._id;typeof t!="function"&&(t=Je(t));for(var i=this._groups,r=i.length,a=new Array(r),s=0;s<r;++s)for(var l=i[s],h=l.length,o=a[s]=new Array(h),c,f,u=0;u<h;++u)(c=l[u])&&(f=t.call(c,c.__data__,u,l))&&("__data__"in c&&(f.__data__=c.__data__),o[u]=f,ue(o[u],e,n,u,o,Y(c,n)));return new st(a,this._parents,e,n)}function zo(t){var e=this._name,n=this._id;typeof t!="function"&&(t=mi(t));for(var i=this._groups,r=i.length,a=[],s=[],l=0;l<r;++l)for(var h=i[l],o=h.length,c,f=0;f<o;++f)if(c=h[f]){for(var u=t.call(c,c.__data__,f,h),p,y=Y(c,n),_=0,S=u.length;_<S;++_)(p=u[_])&&ue(p,e,n,_,u,y);a.push(u),s.push(c)}return new st(a,s,e,n)}var Io=Bt.prototype.constructor;function Ho(){return new Io(this._groups,this._parents)}function Do(t,e){var n,i,r;return function(){var a=wt(this,t),s=(this.style.removeProperty(t),wt(this,t));return a===s?null:a===n&&s===i?r:r=e(n=a,i=s)}}function Hi(t){return function(){this.style.removeProperty(t)}}function Bo(t,e,n){var i,r=n+"",a;return function(){var s=wt(this,t);return s===r?null:s===i?a:a=e(i=s,n)}}function Lo(t,e,n){var i,r,a;return function(){var s=wt(this,t),l=n(this),h=l+"";return l==null&&(h=l=(this.style.removeProperty(t),wt(this,t))),s===h?null:s===i&&h===r?a:(r=h,a=e(i=s,l))}}function Wo(t,e){var n,i,r,a="style."+e,s="end."+a,l;return function(){var h=Q(this,t),o=h.on,c=h.value[a]==null?l||(l=Hi(e)):void 0;(o!==n||r!==c)&&(i=(n=o).copy()).on(s,r=c),h.on=i}}function Po(t,e,n){var i=(t+="")=="transform"?Ws:Ii;return e==null?this.styleTween(t,Do(t,i)).on("end.style."+t,Hi(t)):typeof e=="function"?this.styleTween(t,Lo(t,i,sn(this,"style."+t,e))).each(Wo(this._id,t)):this.styleTween(t,Bo(t,i,e),n).on("end.style."+t,null)}function qo(t,e,n){return function(i){this.style.setProperty(t,e.call(this,i),n)}}function Go(t,e,n){var i,r;function a(){var s=e.apply(this,arguments);return s!==r&&(i=(r=s)&&qo(t,s,n)),i}return a._value=e,a}function Uo(t,e,n){var i="style."+(t+="");if(arguments.length<2)return(i=this.tween(i))&&i._value;if(e==null)return this.tween(i,null);if(typeof e!="function")throw new Error;return this.tween(i,Go(t,e,n??""))}function jo(t){return function(){this.textContent=t}}function Fo(t){return function(){var e=t(this);this.textContent=e??""}}function Xo(t){return this.tween("text",typeof t=="function"?Fo(sn(this,"text",t)):jo(t==null?"":t+""))}function Vo(t){return function(e){this.textContent=t.call(this,e)}}function Yo(t){var e,n;function i(){var r=t.apply(this,arguments);return r!==n&&(e=(n=r)&&Vo(r)),e}return i._value=t,i}function Zo(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(t==null)return this.tween(e,null);if(typeof t!="function")throw new Error;return this.tween(e,Yo(t))}function Ko(){for(var t=this._name,e=this._id,n=Di(),i=this._groups,r=i.length,a=0;a<r;++a)for(var s=i[a],l=s.length,h,o=0;o<l;++o)if(h=s[o]){var c=Y(h,e);ue(h,t,n,o,s,{time:c.time+c.delay+c.duration,delay:0,duration:c.duration,ease:c.ease})}return new st(i,this._parents,t,n)}function Qo(){var t,e,n=this,i=n._id,r=n.size();return new Promise(function(a,s){var l={value:s},h={value:function(){--r===0&&a()}};n.each(function(){var o=Q(this,i),c=o.on;c!==t&&(e=(t=c).copy(),e._.cancel.push(l),e._.interrupt.push(l),e._.end.push(h)),o.on=e}),r===0&&a()})}var Jo=0;function st(t,e,n,i){this._groups=t,this._parents=e,this._name=n,this._id=i}function Di(){return++Jo}var nt=Bt.prototype;st.prototype={constructor:st,select:Oo,selectAll:zo,selectChild:nt.selectChild,selectChildren:nt.selectChildren,filter:No,merge:Eo,selection:Ho,transition:Ko,call:nt.call,nodes:nt.nodes,node:nt.node,size:nt.size,empty:nt.empty,each:nt.each,on:Ro,attr:co,attrTween:mo,style:Po,styleTween:Uo,text:Xo,textTween:Zo,remove:Co,tween:no,delay:vo,duration:bo,ease:So,easeVarying:To,end:Qo,[Symbol.iterator]:nt[Symbol.iterator]};const V=t=>+t;function tl(t){return t*t*t}function We(t){return--t*t*t+1}function Bi(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}var el={time:null,delay:0,duration:250,ease:Bi};function nl(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return n}function il(t){var e,n;t instanceof st?(e=t._id,t=t._name):(e=Di(),(n=el).time=rn(),t=t==null?null:t+"");for(var i=this._groups,r=i.length,a=0;a<r;++a)for(var s=i[a],l=s.length,h,o=0;o<l;++o)(h=s[o])&&ue(h,t,e,o,s,n||nl(h,e));return new st(i,this._parents,t,e)}Bt.prototype.interrupt=Js;Bt.prototype.transition=il;const Pe=Math.PI,qe=2*Pe,ut=1e-6,rl=qe-ut;function Li(t){this._+=t[0];for(let e=1,n=t.length;e<n;++e)this._+=arguments[e]+t[e]}function al(t){let e=Math.floor(t);if(!(e>=0))throw new Error(`invalid digits: ${t}`);if(e>15)return Li;const n=10**e;return function(i){this._+=i[0];for(let r=1,a=i.length;r<a;++r)this._+=Math.round(arguments[r]*n)/n+i[r]}}class sl{constructor(e){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=e==null?Li:al(e)}moveTo(e,n){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(e,n){this._append`L${this._x1=+e},${this._y1=+n}`}quadraticCurveTo(e,n,i,r){this._append`Q${+e},${+n},${this._x1=+i},${this._y1=+r}`}bezierCurveTo(e,n,i,r,a,s){this._append`C${+e},${+n},${+i},${+r},${this._x1=+a},${this._y1=+s}`}arcTo(e,n,i,r,a){if(e=+e,n=+n,i=+i,r=+r,a=+a,a<0)throw new Error(`negative radius: ${a}`);let s=this._x1,l=this._y1,h=i-e,o=r-n,c=s-e,f=l-n,u=c*c+f*f;if(this._x1===null)this._append`M${this._x1=e},${this._y1=n}`;else if(u>ut)if(!(Math.abs(f*h-o*c)>ut)||!a)this._append`L${this._x1=e},${this._y1=n}`;else{let p=i-s,y=r-l,_=h*h+o*o,S=p*p+y*y,v=Math.sqrt(_),k=Math.sqrt(u),O=a*Math.tan((Pe-Math.acos((_+u-S)/(2*v*k)))/2),M=O/k,D=O/v;Math.abs(M-1)>ut&&this._append`L${e+M*c},${n+M*f}`,this._append`A${a},${a},0,0,${+(f*p>c*y)},${this._x1=e+D*h},${this._y1=n+D*o}`}}arc(e,n,i,r,a,s){if(e=+e,n=+n,i=+i,s=!!s,i<0)throw new Error(`negative radius: ${i}`);let l=i*Math.cos(r),h=i*Math.sin(r),o=e+l,c=n+h,f=1^s,u=s?r-a:a-r;this._x1===null?this._append`M${o},${c}`:(Math.abs(this._x1-o)>ut||Math.abs(this._y1-c)>ut)&&this._append`L${o},${c}`,i&&(u<0&&(u=u%qe+qe),u>rl?this._append`A${i},${i},0,1,${f},${e-l},${n-h}A${i},${i},0,1,${f},${this._x1=o},${this._y1=c}`:u>ut&&this._append`A${i},${i},0,${+(u>=Pe)},${f},${this._x1=e+i*Math.cos(a)},${this._y1=n+i*Math.sin(a)}`)}rect(e,n,i,r){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+n}h${i=+i}v${+r}h${-i}Z`}toString(){return this._}}function ol(t){var e=0,n=t.children,i=n&&n.length;if(!i)e=1;else for(;--i>=0;)e+=n[i].value;t.value=e}function ll(){return this.eachAfter(ol)}function cl(t,e){let n=-1;for(const i of this)t.call(e,i,++n,this);return this}function hl(t,e){for(var n=this,i=[n],r,a,s=-1;n=i.pop();)if(t.call(e,n,++s,this),r=n.children)for(a=r.length-1;a>=0;--a)i.push(r[a]);return this}function ul(t,e){for(var n=this,i=[n],r=[],a,s,l,h=-1;n=i.pop();)if(r.push(n),a=n.children)for(s=0,l=a.length;s<l;++s)i.push(a[s]);for(;n=r.pop();)t.call(e,n,++h,this);return this}function fl(t,e){let n=-1;for(const i of this)if(t.call(e,i,++n,this))return i}function dl(t){return this.eachAfter(function(e){for(var n=+t(e.data)||0,i=e.children,r=i&&i.length;--r>=0;)n+=i[r].value;e.value=n})}function pl(t){return this.eachBefore(function(e){e.children&&e.children.sort(t)})}function ml(t){for(var e=this,n=gl(e,t),i=[e];e!==n;)e=e.parent,i.push(e);for(var r=i.length;t!==n;)i.splice(r,0,t),t=t.parent;return i}function gl(t,e){if(t===e)return t;var n=t.ancestors(),i=e.ancestors(),r=null;for(t=n.pop(),e=i.pop();t===e;)r=t,t=n.pop(),e=i.pop();return r}function yl(){for(var t=this,e=[t];t=t.parent;)e.push(t);return e}function vl(){return Array.from(this)}function _l(){var t=[];return this.eachBefore(function(e){e.children||t.push(e)}),t}function wl(){var t=this,e=[];return t.each(function(n){n!==t&&e.push({source:n.parent,target:n})}),e}function*bl(){var t=this,e,n=[t],i,r,a;do for(e=n.reverse(),n=[];t=e.pop();)if(yield t,i=t.children)for(r=0,a=i.length;r<a;++r)n.push(i[r]);while(n.length)}function on(t,e){t instanceof Map?(t=[void 0,t],e===void 0&&(e=kl)):e===void 0&&(e=Sl);for(var n=new Dt(t),i,r=[n],a,s,l,h;i=r.pop();)if((s=e(i.data))&&(h=(s=Array.from(s)).length))for(i.children=s,l=h-1;l>=0;--l)r.push(a=s[l]=new Dt(s[l])),a.parent=i,a.depth=i.depth+1;return n.eachBefore(Nl)}function xl(){return on(this).eachBefore(Tl)}function Sl(t){return t.children}function kl(t){return Array.isArray(t)?t[1]:null}function Tl(t){t.data.value!==void 0&&(t.value=t.data.value),t.data=t.data.data}function Nl(t){var e=0;do t.height=e;while((t=t.parent)&&t.height<++e)}function Dt(t){this.data=t,this.depth=this.height=0,this.parent=null}Dt.prototype=on.prototype={constructor:Dt,count:ll,each:cl,eachAfter:ul,eachBefore:hl,find:fl,sum:dl,sort:pl,path:ml,ancestors:yl,descendants:vl,leaves:_l,links:wl,copy:xl,[Symbol.iterator]:bl};function El(t,e){return t.parent===e.parent?1:2}function Se(t){var e=t.children;return e?e[0]:t.t}function ke(t){var e=t.children;return e?e[e.length-1]:t.t}function $l(t,e,n){var i=n/(e.i-t.i);e.c-=i,e.s+=n,t.c+=i,e.z+=n,e.m+=n}function Al(t){for(var e=0,n=0,i=t.children,r=i.length,a;--r>=0;)a=i[r],a.z+=e,a.m+=e,e+=a.s+(n+=a.c)}function Rl(t,e,n){return t.a.parent===e.parent?t.a:n}function Qt(t,e){this._=t,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=e}Qt.prototype=Object.create(Dt.prototype);function Ml(t){for(var e=new Qt(t,0),n,i=[e],r,a,s,l;n=i.pop();)if(a=n._.children)for(n.children=new Array(l=a.length),s=l-1;s>=0;--s)i.push(r=n.children[s]=new Qt(a[s],s)),r.parent=n;return(e.parent=new Qt(null,0)).children=[e],e}function Cl(){var t=El,e=1,n=1,i=null;function r(o){var c=Ml(o);if(c.eachAfter(a),c.parent.m=-c.z,c.eachBefore(s),i)o.eachBefore(h);else{var f=o,u=o,p=o;o.eachBefore(function(k){k.x<f.x&&(f=k),k.x>u.x&&(u=k),k.depth>p.depth&&(p=k)});var y=f===u?1:t(f,u)/2,_=y-f.x,S=e/(u.x+y+_),v=n/(p.depth||1);o.eachBefore(function(k){k.x=(k.x+_)*S,k.y=k.depth*v})}return o}function a(o){var c=o.children,f=o.parent.children,u=o.i?f[o.i-1]:null;if(c){Al(o);var p=(c[0].z+c[c.length-1].z)/2;u?(o.z=u.z+t(o._,u._),o.m=o.z-p):o.z=p}else u&&(o.z=u.z+t(o._,u._));o.parent.A=l(o,u,o.parent.A||f[0])}function s(o){o._.x=o.z+o.parent.m,o.m+=o.parent.m}function l(o,c,f){if(c){for(var u=o,p=o,y=c,_=u.parent.children[0],S=u.m,v=p.m,k=y.m,O=_.m,M;y=ke(y),u=Se(u),y&&u;)_=Se(_),p=ke(p),p.a=o,M=y.z+k-u.z-S+t(y._,u._),M>0&&($l(Rl(y,o,f),o,M),S+=M,v+=M),k+=y.m,S+=u.m,O+=_.m,v+=p.m;y&&!ke(p)&&(p.t=y,p.m+=k-v),u&&!Se(_)&&(_.t=u,_.m+=S-O,f=o)}return f}function h(o){o.x*=e,o.y=o.depth*n}return r.separation=function(o){return arguments.length?(t=o,r):t},r.size=function(o){return arguments.length?(i=!1,e=+o[0],n=+o[1],r):i?null:[e,n]},r.nodeSize=function(o){return arguments.length?(i=!0,e=+o[0],n=+o[1],r):i?[e,n]:null},r}function In(t){return function(){return t}}function Ol(t){let e=3;return t.digits=function(n){if(!arguments.length)return e;if(n==null)e=null;else{const i=Math.floor(n);if(!(i>=0))throw new RangeError(`invalid digits: ${n}`);e=i}return t},()=>new sl(e)}var zl=Array.prototype.slice;function Il(t){return t[0]}function Hl(t){return t[1]}class Dl{constructor(e,n){this._context=e,this._x=n}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(e,n){switch(e=+e,n=+n,this._point){case 0:{this._point=1,this._line?this._context.lineTo(e,n):this._context.moveTo(e,n);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+e)/2,this._y0,this._x0,n,e,n):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+n)/2,e,this._y0,e,n);break}}this._x0=e,this._y0=n}}function Bl(t){return new Dl(t,!0)}function Ll(t){return t.source}function Wl(t){return t.target}function Pl(t){let e=Ll,n=Wl,i=Il,r=Hl,a=null,s=null,l=Ol(h);function h(){let o;const c=zl.call(arguments),f=e.apply(this,c),u=n.apply(this,c);if(a==null&&(s=t(o=l())),s.lineStart(),c[0]=f,s.point(+i.apply(this,c),+r.apply(this,c)),c[0]=u,s.point(+i.apply(this,c),+r.apply(this,c)),s.lineEnd(),o)return s=null,o+""||null}return h.source=function(o){return arguments.length?(e=o,h):e},h.target=function(o){return arguments.length?(n=o,h):n},h.x=function(o){return arguments.length?(i=typeof o=="function"?o:In(+o),h):i},h.y=function(o){return arguments.length?(r=typeof o=="function"?o:In(+o),h):r},h.context=function(o){return arguments.length?(o==null?a=s=null:s=t(a=o),h):a},h}const jt=t=>()=>t;function ql(t,{sourceEvent:e,target:n,transform:i,dispatch:r}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:i,enumerable:!0,configurable:!0},_:{value:r}})}function at(t,e,n){this.k=t,this.x=e,this.y=n}at.prototype={constructor:at,scale:function(t){return t===1?this:new at(this.k*t,this.x,this.y)},translate:function(t,e){return t===0&e===0?this:new at(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var Wi=new at(1,0,0);at.prototype;function Te(t){t.stopImmediatePropagation()}function At(t){t.preventDefault(),t.stopImmediatePropagation()}function Gl(t){return(!t.ctrlKey||t.type==="wheel")&&!t.button}function Ul(){var t=this;return t instanceof SVGElement?(t=t.ownerSVGElement||t,t.hasAttribute("viewBox")?(t=t.viewBox.baseVal,[[t.x,t.y],[t.x+t.width,t.y+t.height]]):[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]):[[0,0],[t.clientWidth,t.clientHeight]]}function Hn(){return this.__zoom||Wi}function jl(t){return-t.deltaY*(t.deltaMode===1?.05:t.deltaMode?1:.002)*(t.ctrlKey?10:1)}function Fl(){return navigator.maxTouchPoints||"ontouchstart"in this}function Xl(t,e,n){var i=t.invertX(e[0][0])-n[0][0],r=t.invertX(e[1][0])-n[1][0],a=t.invertY(e[0][1])-n[0][1],s=t.invertY(e[1][1])-n[1][1];return t.translate(r>i?(i+r)/2:Math.min(0,i)||Math.max(0,r),s>a?(a+s)/2:Math.min(0,a)||Math.max(0,s))}function Vl(){var t=Gl,e=Ul,n=Xl,i=jl,r=Fl,a=[0,1/0],s=[[-1/0,-1/0],[1/0,1/0]],l=250,h=js,o=Ke("start","zoom","end"),c,f,u,p=500,y=150,_=0,S=10;function v(d){d.property("__zoom",Hn).on("wheel.zoom",I,{passive:!1}).on("mousedown.zoom",T).on("dblclick.zoom",N).filter(r).on("touchstart.zoom",U).on("touchmove.zoom",W).on("touchend.zoom touchcancel.zoom",J).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}v.transform=function(d,b,m,x){var E=d.selection?d.selection():d;E.property("__zoom",Hn),d!==E?D(d,b,m,x):E.interrupt().each(function(){P(this,arguments).event(x).start().zoom(null,typeof b=="function"?b.apply(this,arguments):b).end()})},v.scaleBy=function(d,b,m,x){v.scaleTo(d,function(){var E=this.__zoom.k,$=typeof b=="function"?b.apply(this,arguments):b;return E*$},m,x)},v.scaleTo=function(d,b,m,x){v.transform(d,function(){var E=e.apply(this,arguments),$=this.__zoom,A=m==null?M(E):typeof m=="function"?m.apply(this,arguments):m,C=$.invert(A),B=typeof b=="function"?b.apply(this,arguments):b;return n(O(k($,B),A,C),E,s)},m,x)},v.translateBy=function(d,b,m,x){v.transform(d,function(){return n(this.__zoom.translate(typeof b=="function"?b.apply(this,arguments):b,typeof m=="function"?m.apply(this,arguments):m),e.apply(this,arguments),s)},null,x)},v.translateTo=function(d,b,m,x,E){v.transform(d,function(){var $=e.apply(this,arguments),A=this.__zoom,C=x==null?M($):typeof x=="function"?x.apply(this,arguments):x;return n(Wi.translate(C[0],C[1]).scale(A.k).translate(typeof b=="function"?-b.apply(this,arguments):-b,typeof m=="function"?-m.apply(this,arguments):-m),$,s)},x,E)};function k(d,b){return b=Math.max(a[0],Math.min(a[1],b)),b===d.k?d:new at(b,d.x,d.y)}function O(d,b,m){var x=b[0]-m[0]*d.k,E=b[1]-m[1]*d.k;return x===d.x&&E===d.y?d:new at(d.k,x,E)}function M(d){return[(+d[0][0]+ +d[1][0])/2,(+d[0][1]+ +d[1][1])/2]}function D(d,b,m,x){d.on("start.zoom",function(){P(this,arguments).event(x).start()}).on("interrupt.zoom end.zoom",function(){P(this,arguments).event(x).end()}).tween("zoom",function(){var E=this,$=arguments,A=P(E,$).event(x),C=e.apply(E,$),B=m==null?M(C):typeof m=="function"?m.apply(E,$):m,Z=Math.max(C[1][0]-C[0][0],C[1][1]-C[0][1]),L=E.__zoom,j=typeof b=="function"?b.apply(E,$):b,tt=h(L.invert(B).concat(Z/L.k),j.invert(B).concat(Z/j.k));return function(F){if(F===1)F=j;else{var et=tt(F),_e=Z/et[2];F=new at(_e,B[0]-et[0]*_e,B[1]-et[1]*_e)}A.zoom(null,F)}})}function P(d,b,m){return!m&&d.__zooming||new w(d,b)}function w(d,b){this.that=d,this.args=b,this.active=0,this.sourceEvent=null,this.extent=e.apply(d,b),this.taps=0}w.prototype={event:function(d){return d&&(this.sourceEvent=d),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(d,b){return this.mouse&&d!=="mouse"&&(this.mouse[1]=b.invert(this.mouse[0])),this.touch0&&d!=="touch"&&(this.touch0[1]=b.invert(this.touch0[0])),this.touch1&&d!=="touch"&&(this.touch1[1]=b.invert(this.touch1[0])),this.that.__zoom=b,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(d){var b=H(this.that).datum();o.call(d,this.that,new ql(d,{sourceEvent:this.sourceEvent,target:v,type:d,transform:this.that.__zoom,dispatch:o}),b)}};function I(d,...b){if(!t.apply(this,arguments))return;var m=P(this,b).event(d),x=this.__zoom,E=Math.max(a[0],Math.min(a[1],x.k*Math.pow(2,i.apply(this,arguments)))),$=ht(d);if(m.wheel)(m.mouse[0][0]!==$[0]||m.mouse[0][1]!==$[1])&&(m.mouse[1]=x.invert(m.mouse[0]=$)),clearTimeout(m.wheel);else{if(x.k===E)return;m.mouse=[$,x.invert($)],Kt(this),m.start()}At(d),m.wheel=setTimeout(A,y),m.zoom("mouse",n(O(k(x,E),m.mouse[0],m.mouse[1]),m.extent,s));function A(){m.wheel=null,m.end()}}function T(d,...b){if(u||!t.apply(this,arguments))return;var m=d.currentTarget,x=P(this,b,!0).event(d),E=H(d.view).on("mousemove.zoom",B,!0).on("mouseup.zoom",Z,!0),$=ht(d,m),A=d.clientX,C=d.clientY;vs(d.view),Te(d),x.mouse=[$,this.__zoom.invert($)],Kt(this),x.start();function B(L){if(At(L),!x.moved){var j=L.clientX-A,tt=L.clientY-C;x.moved=j*j+tt*tt>_}x.event(L).zoom("mouse",n(O(x.that.__zoom,x.mouse[0]=ht(L,m),x.mouse[1]),x.extent,s))}function Z(L){E.on("mousemove.zoom mouseup.zoom",null),_s(L.view,x.moved),At(L),x.event(L).end()}}function N(d,...b){if(t.apply(this,arguments)){var m=this.__zoom,x=ht(d.changedTouches?d.changedTouches[0]:d,this),E=m.invert(x),$=m.k*(d.shiftKey?.5:2),A=n(O(k(m,$),x,E),e.apply(this,b),s);At(d),l>0?H(this).transition().duration(l).call(D,A,x,d):H(this).call(v.transform,A,x,d)}}function U(d,...b){if(t.apply(this,arguments)){var m=d.touches,x=m.length,E=P(this,b,d.changedTouches.length===x).event(d),$,A,C,B;for(Te(d),A=0;A<x;++A)C=m[A],B=ht(C,this),B=[B,this.__zoom.invert(B),C.identifier],E.touch0?!E.touch1&&E.touch0[2]!==B[2]&&(E.touch1=B,E.taps=0):(E.touch0=B,$=!0,E.taps=1+!!c);c&&(c=clearTimeout(c)),$&&(E.taps<2&&(f=B[0],c=setTimeout(function(){c=null},p)),Kt(this),E.start())}}function W(d,...b){if(this.__zooming){var m=P(this,b).event(d),x=d.changedTouches,E=x.length,$,A,C,B;for(At(d),$=0;$<E;++$)A=x[$],C=ht(A,this),m.touch0&&m.touch0[2]===A.identifier?m.touch0[0]=C:m.touch1&&m.touch1[2]===A.identifier&&(m.touch1[0]=C);if(A=m.that.__zoom,m.touch1){var Z=m.touch0[0],L=m.touch0[1],j=m.touch1[0],tt=m.touch1[1],F=(F=j[0]-Z[0])*F+(F=j[1]-Z[1])*F,et=(et=tt[0]-L[0])*et+(et=tt[1]-L[1])*et;A=k(A,Math.sqrt(F/et)),C=[(Z[0]+j[0])/2,(Z[1]+j[1])/2],B=[(L[0]+tt[0])/2,(L[1]+tt[1])/2]}else if(m.touch0)C=m.touch0[0],B=m.touch0[1];else return;m.zoom("touch",n(O(A,C,B),m.extent,s))}}function J(d,...b){if(this.__zooming){var m=P(this,b).event(d),x=d.changedTouches,E=x.length,$,A;for(Te(d),u&&clearTimeout(u),u=setTimeout(function(){u=null},p),$=0;$<E;++$)A=x[$],m.touch0&&m.touch0[2]===A.identifier?delete m.touch0:m.touch1&&m.touch1[2]===A.identifier&&delete m.touch1;if(m.touch1&&!m.touch0&&(m.touch0=m.touch1,delete m.touch1),m.touch0)m.touch0[1]=this.__zoom.invert(m.touch0[0]);else if(m.end(),m.taps===2&&(A=ht(A,this),Math.hypot(f[0]-A[0],f[1]-A[1])<S)){var C=H(this).on("dblclick.zoom");C&&C.apply(this,arguments)}}}return v.wheelDelta=function(d){return arguments.length?(i=typeof d=="function"?d:jt(+d),v):i},v.filter=function(d){return arguments.length?(t=typeof d=="function"?d:jt(!!d),v):t},v.touchable=function(d){return arguments.length?(r=typeof d=="function"?d:jt(!!d),v):r},v.extent=function(d){return arguments.length?(e=typeof d=="function"?d:jt([[+d[0][0],+d[0][1]],[+d[1][0],+d[1][1]]]),v):e},v.scaleExtent=function(d){return arguments.length?(a[0]=+d[0],a[1]=+d[1],v):[a[0],a[1]]},v.translateExtent=function(d){return arguments.length?(s[0][0]=+d[0][0],s[1][0]=+d[1][0],s[0][1]=+d[0][1],s[1][1]=+d[1][1],v):[[s[0][0],s[0][1]],[s[1][0],s[1][1]]]},v.constrain=function(d){return arguments.length?(n=d,v):n},v.duration=function(d){return arguments.length?(l=+d,v):l},v.interpolate=function(d){return arguments.length?(h=d,v):h},v.on=function(){var d=o.on.apply(o,arguments);return d===o?v:d},v.clickDistance=function(d){return arguments.length?(_=(d=+d)*d,v):Math.sqrt(_)},v.tapDistance=function(d){return arguments.length?(S=+d,v):S},v}var Yl=Object.defineProperty,Zl=(t,e,n)=>e in t?Yl(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,g=(t,e,n)=>(Zl(t,typeof e!="symbol"?e+"":e,n),n),R=(t=>(t.DOUBLE_ELIMINATION="DOUBLE_ELIMINATION",t.SINGLE_ELIMINATION="SINGLE_ELIMINATION",t.LADDER="LADDER",t.SWISS="SWISS",t.ROUND_ROBIN="ROUND_ROBIN",t))(R||{}),rt=(t=>(t.UNKNOWN="UNKNOWN",t.NOT_STARTED="NOT_STARTED",t.IN_PROGRESS="IN_PROGRESS",t.COMPLETED="COMPLETED",t))(rt||{}),ft=(t=>(t.ALL_MATCHES="ALL_MATCHES",t.WINNERS="WINNERS",t.LOSERS="LOSERS",t))(ft||{}),gt=(t=>(t[t.WINNERS=0]="WINNERS",t[t.LOSERS=1]="LOSERS",t))(gt||{});class Kl{constructor(e,n,i){g(this,"svg"),g(this,"linkGroup"),g(this,"domElementContainer"),g(this,"bracketHeader"),g(this,"bracketTitle"),g(this,"roundLabelContainer"),g(this,"width"),g(this,"height"),g(this,"animator"),g(this,"formatter"),g(this,"hierarchy"),g(this,"onCellCreation"),g(this,"onCellUpdate"),this.height=n,this.width=e,this.animator=i.animator,this.formatter=i.formatter,this.onCellCreation=i.onCellCreation,this.onCellUpdate=i.onCellUpdate,this.svg=yt("svg").classed("elimination-renderer__links",!0).attr("viewBox",[0,0,e,n]).attr("width",e).attr("height",n).style("max-width","100%").style("height","auto"),this.linkGroup=this.svg.append("g").classed("elimination-renderer__link-group",!0).attr("transform-origin","0 0"),this.domElementContainer=yt("div").style("transform-origin","0 0"),this.bracketHeader=this.domElementContainer.append("div").style("position","absolute").classed("bracket-header",!0),this.bracketTitle=this.bracketHeader.append("div").classed("elimination-renderer__bracket-title",!0),this.roundLabelContainer=this.bracketHeader.append("div").classed("elimination-renderer__round-labels",!0),this.hierarchy=null}destroy(){this.svg.remove(),this.domElementContainer.remove()}getElements(){return[this.domElementContainer.node(),this.svg.node()]}setData(e,n){var i;if(this.hierarchy=e,e.length===0)return this.getElements().forEach(w=>w.style.display="none"),{width:0,height:0};this.getElements().forEach(w=>w.style.removeProperty("display"));const r=n.cellOffset??0,a=n.hasBracketReset??!1;this.bracketTitle.text(n.bracketTitle??""),this.roundLabelContainer.style("column-gap",`${n.linkWidth}px`).style("grid-auto-columns",`${n.cellWidth}px`).selectAll("div.round-label").data(Ir(e.height)).join("div").classed("round-label",!0).text(w=>this.formatter.formatEliminationRoundNumber(w+1,e.height,n.isLosersBracket,a,n.bracketType));const s=n.bracketHeaderOffset??8,l=((i=this.bracketHeader.node())==null?void 0:i.offsetHeight)??0;this.bracketHeader.style("transform",`translate(${r*(n.cellWidth+n.linkWidth)}px, ${n.yOffset??0}px)`);const h=Cl().separation((w,I)=>n.hasThirdPlaceMatch&&(w.data.type===gt.LOSERS||I.data.type===gt.LOSERS)?2:n.cellSeparation).nodeSize([n.cellHeight,n.cellWidth+n.linkWidth])(e);let o=1/0,c=-o;h.each(w=>{"isRoot"in w.data||(w.x>c&&(c=w.x),w.x<o&&(o=w.x))});const f=h.links().filter(w=>!("isRoot"in w.target.data)&&!("isRoot"in w.source.data)).map(w=>({...w,source:{...w.source,y:w.source.y+n.cellWidth/2},target:{...w.target,y:w.target.y-n.cellWidth/2}})),u=(n.yOffset??0)+l+s,p=n.cellWidth*(e.height+r)+n.linkWidth*(e.height-1+r),y=this.width-p,_=-n.cellWidth/2-n.linkWidth+y,S=o-n.cellHeight/2-u;this.svg.attr("viewBox",[_,S,this.width,this.height]),this.linkGroup.attr("transform-origin",`${_} ${S}`),this.linkGroup.selectAll("path").data(f).join("path").attr("d",Pl(Bl).y(w=>w.x).x(w=>this.width-w.y)).attr("pathLength",1).attr("data-depth",w=>w.source.depth).classed("bracket-link",!0);const v=(w,I,T)=>{const N=this;return w.append("div").classed("match-cell__team-name",!0).classed(`match-cell__${I}-team-name`,!0).each(function(U){const W=T(U);N.animator.setTeamName(this,"",N.formatter.formatTeamName(W.name),W.isDisqualified,n.bracketType)})},k=(w,I,T)=>{const N=this;return w.append("div").classed("match-cell__score-wrapper",!0).append("div").classed("match-cell__score",!0).classed(`match-cell__${I}-score`,!0).each(function(U){const W=T(U);N.animator.setScore(this,0,W.score??NaN,N.formatter.formatScore(W.score,W.isDisqualified,n.bracketType,U.data.state),W.isDisqualified,n.bracketType)})},O=w=>{const I=n.thirdPlaceMatchLabelHeight;w.each(function(T){P(T)&&H(this).classed("has-third-place-match-label",!0).append("div").classed("match-cell__third-place-match-label",!0).style("height",`${I}px`).text("Third place match")})},M=(w,I,T)=>{const N=this;return w.select(`.match-cell__${I}-team-name`).each(function(U){const W=this.textContent??"",J=T(U),d=N.formatter.formatTeamName(J.name);W!==d&&N.animator.animateTeamNameUpdate(this,W,d,J.isDisqualified,n.bracketType)})},D=(w,I,T)=>{const N=this;return w.select(`.match-cell__${I}-score`).each(function(U){const W=parseInt(this.textContent??""),J=T(U),d=J.score??NaN;W!==d&&!(isNaN(W)&&(isNaN(d)||J.isDisqualified))&&N.animator.animateScoreUpdate(this,W,d,N.formatter.formatScore(d,J.isDisqualified,n.bracketType,U.data.state),J.isDisqualified,n.bracketType)})},P=w=>w.data.type===gt.LOSERS&&n.hasThirdPlaceMatch;return this.domElementContainer.selectAll("div.match-cell-wrapper").data(e.descendants().filter(w=>!("isRoot"in w.data)),w=>w.data.id).join(w=>{const I=w.append("div").style("height",T=>P(T)?`${n.cellHeight+n.thirdPlaceMatchLabelHeight}px`:`${n.cellHeight}px`).style("width",`${n.cellWidth}px`).style("left",T=>`${this.width-T.y+n.linkWidth-y}px`).style("top",T=>`${T.x-n.cellHeight/2-o+n.cellHeight/2+u}px`).style("position","absolute").classed("match-cell-wrapper",!0).attr("data-depth",T=>T.depth);return I.append("div").classed("match-cell",!0).call(O).call(v,"top",T=>{var N;return(N=T.data)==null?void 0:N.topTeam}).call(k,"top",T=>{var N;return(N=T.data)==null?void 0:N.topTeam}).call(v,"bottom",T=>{var N;return(N=T.data)==null?void 0:N.bottomTeam}).call(k,"bottom",T=>{var N;return(N=T.data)==null?void 0:N.bottomTeam}),this.onCellCreation?I.call(this.onCellCreation):I},w=>{const I=w.style("left",T=>`${this.width-T.y+n.linkWidth-y}px`).style("top",T=>`${T.x-n.cellHeight/2-o+n.cellHeight/2+u}px`).style("height",T=>P(T)?`${n.cellHeight+n.thirdPlaceMatchLabelHeight}px`:`${n.cellHeight}px`).style("width",`${n.cellWidth}px`).call(M,"top",T=>{var N;return(N=T.data)==null?void 0:N.topTeam}).call(D,"top",T=>{var N;return(N=T.data)==null?void 0:N.topTeam}).call(M,"bottom",T=>{var N;return(N=T.data)==null?void 0:N.bottomTeam}).call(D,"bottom",T=>{var N;return(N=T.data)==null?void 0:N.bottomTeam});return this.onCellUpdate?I.call(this.onCellUpdate):I}),{width:p,height:this.measureHierarchy(e,n.cellHeight,n.cellSeparation)+l+s}}measureHierarchy(e,n,i){const r={};return e.each(a=>{r[a.depth]==null?r[a.depth]=1:r[a.depth]++}),(Math.max(...Object.values(r))-1)*(n*i)+n}}class fe{}g(fe,"compatibleBracketTypes");class ae{constructor(e,n,i=2){g(this,"zoomBehavior"),g(this,"resizeObserver"),g(this,"container"),g(this,"containerWidth"),g(this,"containerHeight"),g(this,"contentWidth"),g(this,"contentHeight"),g(this,"maxScale"),this.zoomBehavior=Vl().extent([[0,0],[2048,2048]]).on("zoom",r=>n(r)),this.maxScale=i,this.container=e,this.resizeObserver=new ResizeObserver(r=>{if(r.length<1){console.error(`Received resize event with ${r.length} entries; cannot continue`);return}else r.length>1&&console.warn(`Received resize event with ${r.length} entries; expected 1`);const a=r[0];this.containerHeight=a.contentBoxSize[0].blockSize,this.containerWidth=a.contentBoxSize[0].inlineSize,this.calculateZoom()}),this.resizeObserver.observe(e.node())}recalculateContainerSize(){const e=this.container.node().getBoundingClientRect();this.containerWidth=e.width,this.containerHeight=e.height,this.calculateZoom()}setContentSize(e,n){this.contentWidth=e,this.contentHeight=n,this.calculateZoom()}calculateZoom(){this.containerHeight==null||this.containerWidth==null||this.contentHeight==null||this.contentWidth==null||(this.zoomBehavior.extent([[0,0],[this.containerWidth,this.containerHeight]]),this.zoomBehavior.translateTo(this.container,this.contentWidth/2,this.contentHeight/2),this.zoomBehavior.scaleTo(this.container,Math.min(this.containerHeight/this.contentHeight,this.containerWidth/this.contentWidth,this.maxScale)))}disconnect(){this.resizeObserver.disconnect()}static toCSSTransform(e){return`translate(${e.transform.x}px, ${e.transform.y}px) scale(${e.transform.k})`}}const lt=2048;class Ge extends fe{constructor(e){super(),g(this,"topRenderer"),g(this,"bottomRenderer"),g(this,"animator"),g(this,"formatter"),g(this,"element"),g(this,"svg"),g(this,"matchCellWrapper"),g(this,"linkWrapper"),g(this,"linkWidth"),g(this,"cellHeight"),g(this,"minCellWidth"),g(this,"maxCellWidth"),g(this,"onCellCreation"),g(this,"onCellUpdate"),g(this,"thirdPlaceMatchLabelHeight"),g(this,"activeBracketId"),g(this,"activeMatchType"),g(this,"renderedBracketWidth"),g(this,"renderedBracketHeight"),g(this,"zoomer"),this.animator=e.animator,this.formatter=e.formatter,this.linkWidth=e.linkWidth??50,this.cellHeight=e.cellHeight??65,this.minCellWidth=e.minCellWidth??175,this.maxCellWidth=e.maxCellWidth??250,this.onCellCreation=e.onCellCreation,this.onCellUpdate=e.onCellUpdate,this.activeBracketId=null,this.renderedBracketWidth=1,this.renderedBracketHeight=1,this.thirdPlaceMatchLabelHeight=e.thirdPlaceMatchLabelHeight??20,this.element=yt("div").classed("elimination-renderer",!0).style("position","relative").style("overflow","hidden"),this.matchCellWrapper=this.element.append("div").style("transform-origin","0 0"),this.svg=this.element.append("svg").attr("viewBox",[0,0,lt,lt]).attr("width",lt).attr("height",lt),this.linkWrapper=this.svg.append("g").attr("transform-origin","0 0").attr("fill","none").attr("stroke","#555").attr("stroke-width",1.5),this.topRenderer=this.createSingleElimRenderer(),this.bottomRenderer=null,this.zoomer=new ae(this.element,this.onZoom.bind(this),e.maxScale??1.5)}async hide(){if(this.activeBracketId!=null){const e=this.getElement();this.animator.eliminationAnimator.beforeHide(e,this),await this.animator.eliminationAnimator.hide(e,this),e.style.visibility="hidden"}}install(e){e.appendChild(this.getElement()),this.zoomer.recalculateContainerSize()}destroy(){this.zoomer.disconnect(),this.element.remove()}async setData(e){if(e.matchGroups.length!==1)throw new Error(`Rendering elimination groups requires only one bracket group to be present! (Found ${e.matchGroups.length})`);const n=e.matchGroups[0],i=n.id!==this.activeBracketId||this.activeMatchType!==n.containedMatchType;i&&await this.hide(),this.activeBracketId=n.id,this.activeMatchType=n.containedMatchType;const r=e.type;if((e.type===R.SINGLE_ELIMINATION||e.type===R.DOUBLE_ELIMINATION&&n.containedMatchType!==ft.ALL_MATCHES)&&this.bottomRenderer!=null?(this.bottomRenderer.destroy(),this.bottomRenderer=null):e.type===R.DOUBLE_ELIMINATION&&n.containedMatchType!==ft.WINNERS&&this.bottomRenderer==null&&(this.bottomRenderer=this.createSingleElimRenderer()),e.type===R.SINGLE_ELIMINATION||n.containedMatchType!==ft.ALL_MATCHES){const a=this.buildMatchHierarchy(n.matches),s=this.getCellSeparation(a.height),l=this.topRenderer.setData(a,{cellWidth:this.getCellWidth(a),cellSeparation:s,linkWidth:this.linkWidth,cellHeight:this.cellHeight,hasThirdPlaceMatch:e.type===R.SINGLE_ELIMINATION&&n.matches.some(h=>h.type===gt.LOSERS),bracketType:r,hasBracketReset:e.type===R.DOUBLE_ELIMINATION&&n.containedMatchType===ft.WINNERS&&(n.hasBracketReset??!0),bracketTitle:e.type===R.DOUBLE_ELIMINATION?n.containedMatchType===ft.WINNERS?"Winners Bracket":"Losers Bracket":void 0,thirdPlaceMatchLabelHeight:this.thirdPlaceMatchLabelHeight,isLosersBracket:e.type===R.DOUBLE_ELIMINATION&&n.containedMatchType===ft.LOSERS});this.renderedBracketHeight=l.height,this.renderedBracketWidth=l.width}else{const a=this.buildMatchHierarchy(n.matches.filter(u=>u.type===gt.WINNERS)),s=this.buildMatchHierarchy(n.matches.filter(u=>u.type===gt.LOSERS)),l=Math.min(this.getCellWidth(a),this.getCellWidth(s,!0)),h=this.getCellSeparation(a.height),o=this.getCellSeparation(s.height),c=this.topRenderer.setData(a,{cellWidth:l,cellSeparation:h,linkWidth:this.linkWidth,cellHeight:this.cellHeight,hasThirdPlaceMatch:!1,hasBracketReset:n.hasBracketReset??!0,bracketTitle:"Winners Bracket",bracketType:r,thirdPlaceMatchLabelHeight:this.thirdPlaceMatchLabelHeight,isLosersBracket:!1}),f=this.bottomRenderer.setData(s,{cellWidth:l,cellSeparation:o,linkWidth:this.linkWidth,cellHeight:this.cellHeight,cellOffset:1,yOffset:c.height+this.cellHeight/2,hasThirdPlaceMatch:!1,bracketTitle:"Losers Bracket",bracketType:r,thirdPlaceMatchLabelHeight:this.thirdPlaceMatchLabelHeight,isLosersBracket:!0});this.renderedBracketHeight=c.height+this.cellHeight/2+f.height,this.renderedBracketWidth=Math.max(c.width,f.width)}if(this.zoomer.setContentSize(this.renderedBracketWidth,this.renderedBracketHeight),i){const a=this.getElement();this.animator.eliminationAnimator.beforeReveal(a,this),a.style.visibility="visible",await this.animator.eliminationAnimator.reveal(a,this)}}getElement(){return this.element.node()}getBracketDepth(){var e,n,i;return Math.max(((e=this.topRenderer.hierarchy)==null?void 0:e.height)??0,((i=(n=this.bottomRenderer)==null?void 0:n.hierarchy)==null?void 0:i.height)??0)}createSingleElimRenderer(){const e=new Kl(lt,lt,{animator:this.animator,formatter:this.formatter,onCellCreation:this.onCellCreation,onCellUpdate:this.onCellUpdate}),n=e.getElements();return this.matchCellWrapper.append(()=>n[0]),this.linkWrapper.append(()=>n[1]),e}buildMatchHierarchy(e){const n=Math.max(...e.map(i=>i.roundNumber??0));return on({isRoot:!0},i=>"isRoot"in i&&i.isRoot?e.filter(r=>r.roundNumber===n):e.filter(r=>i.id===r.nextMatchId))}getCellWidth(e,n=!1){const i=n?(lt-this.linkWidth*e.height)/(e.height+1):(lt-this.linkWidth*(e.height-1))/e.height;return Math.max(Math.min(i,this.maxCellWidth),this.minCellWidth)}onZoom(e){this.linkWrapper.selectAll(".elimination-renderer__link-group").attr("transform",e.transform.toString()),this.matchCellWrapper.style("transform",ae.toCSSTransform(e))}getCellSeparation(e){switch(e){case 2:return 3;case 3:return 2;case 4:return 1.25;default:return 1.1}}}g(Ge,"compatibleBracketTypes",[R.DOUBLE_ELIMINATION,R.SINGLE_ELIMINATION]);const Dn=35,Ne="scroll-masked";class Ql{constructor(e){g(this,"target"),g(this,"listenerFunction"),this.target=e,this.listenerFunction=()=>this.refreshMask()}start(){this.refreshMask(),this.target.classList.contains(Ne)||(this.target.classList.add(Ne),this.target.addEventListener("scroll",this.listenerFunction))}stop(){this.target.removeEventListener("scroll",this.listenerFunction),this.target.classList.remove(Ne,"scroll-mask-top","scroll-mask-bottom")}refreshMask(){this.toggleMask("top",this.target.scrollTop>Dn),this.toggleMask("bottom",Math.abs(this.target.scrollHeight-this.target.clientHeight-this.target.scrollTop)>=Dn)}toggleMask(e,n){n?this.target.classList.add(`scroll-mask-${e}`):this.target.classList.remove(`scroll-mask-${e}`)}}class Jl{constructor(e,n,i,r){g(this,"target"),g(this,"targetSelection"),g(this,"rowGap"),g(this,"rowHeight"),g(this,"rowsPerScreen"),g(this,"direction"),g(this,"scrollTopTo"),g(this,"scrollMask"),g(this,"started"),g(this,"targetHeight"),this.target=e,this.targetSelection=H(e),this.rowHeight=n,this.rowGap=i,this.direction="up",this.target.scrollTop=0,this.scrollTopTo=0,this.started=!1,this.scrollMask=r?new Ql(e):null,this.initScrollMask(),this.targetHeight=0}setHeights(e,n){this.resetPosition(),this.targetHeight=e,this.rowsPerScreen=n,this.start()}initScrollMask(){var e;this.targetIsScrollable()&&((e=this.scrollMask)==null||e.start())}start(){var e;if(!this.started){if(!this.targetIsScrollable()){(e=this.scrollMask)==null||e.stop();return}this.initScrollMask(),this.started=!0,this.scroll()}}scroll(){this.scrollingFinished()&&(this.direction=this.direction==="down"?"up":"down");const e=this.scrollTopTo,n=this.getNextScrollTop();this.scrollTopTo=n,this.targetSelection.transition("scroll").duration(750).delay(5e3).on("end",()=>{this.scroll()}).tween("scroll",()=>{const i=it(e,n);return function(r){this.scrollTop=i(r)}})}resetPosition(){this.targetSelection.interrupt("scroll"),this.target.scrollTop=0,this.scrollTopTo=0,this.direction="up",this.started=!1}stop(){var e;this.resetPosition(),(e=this.scrollMask)==null||e.stop()}targetIsScrollable(){return this.rowsPerScreen!=null&&this.target.scrollHeight>this.targetHeight}getNextScrollTop(){if(this.direction==="up")return 0;if(this.rowsPerScreen==null)throw new Error("Tried starting an autoscroller without telling it the target element's height first");return Math.min(this.scrollTopTo+(this.rowHeight+this.rowGap)*(this.rowsPerScreen-1),this.maxScrollTop())}scrollingFinished(){return this.direction==="up"&&this.target.scrollTop<=0||this.direction==="down"&&Math.abs(this.target.scrollHeight-this.targetHeight-this.target.scrollTop)<1}maxScrollTop(){return this.target.scrollHeight-this.targetHeight}}class Ue extends fe{constructor(e){super(),g(this,"wrapper"),g(this,"element"),g(this,"rowHeight"),g(this,"rowGap"),g(this,"formatter"),g(this,"scroller"),g(this,"animator"),g(this,"activeBracketId"),g(this,"activeRoundNumber"),g(this,"resizeObserver"),this.formatter=e.formatter,this.animator=e.animator,this.activeBracketId=null,this.rowHeight=e.rowHeight??50,this.rowGap=e.rowGap??5,this.wrapper=yt("div").classed("swiss-renderer__wrapper",!0),this.element=this.wrapper.append("div").classed("swiss-renderer",!0).style("grid-auto-rows",`${this.rowHeight}px`).style("row-gap",`${this.rowGap}px`),this.resizeObserver=new ResizeObserver(n=>{for(const i of n)i.contentBoxSize&&this.handleHeightChange(i.contentBoxSize[0].blockSize)}),this.resizeObserver.observe(this.wrapper.node()),this.scroller=new Jl(this.element.node(),this.rowHeight,this.rowGap,e.useScrollMask??!1)}handleHeightChange(e){const n=Math.floor((e+this.rowGap)/(this.rowHeight+this.rowGap)),i=n*(this.rowHeight+this.rowGap)-this.rowGap;this.element.style("max-height",`${i}px`),this.scroller.setHeights(i,n)}install(e){const n=this.getElement();e.appendChild(n),this.handleHeightChange(n.getBoundingClientRect().height)}destroy(){this.wrapper.remove(),this.resizeObserver.disconnect()}getElement(){return this.wrapper.node()}async hide(){if(this.activeBracketId!=null){const e=this.getElement();this.animator.swissAnimator.beforeHide(e,this),await this.animator.swissAnimator.hide(e,this),this.scroller.stop(),e.style.visibility="hidden"}}async setData(e){if(e.matchGroups.length!==1)throw new Error(`Rendering swiss groups requires only one bracket group to be present! (Found ${e.matchGroups.length})`);const n=e.matchGroups[0],i=n.id!==this.activeBracketId||e.roundNumber!==this.activeRoundNumber;i&&await this.hide(),this.activeBracketId=n.id,this.activeRoundNumber=e.roundNumber;const r=(o,c,f)=>{const u=this;return o.append("div").classed("match-row__team-name",!0).classed(`match-row__${c}-team-name`,!0).each(function(p){const y=f(p);u.animator.setTeamName(this,"",u.formatter.formatTeamName(y.name),y.isDisqualified,R.SWISS)})},a=(o,c,f)=>{const u=this;return o.append("div").classed("match-row__score-wrapper",!0).append("div").classed("match-row__score",!0).classed(`match-row__${c}-score`,!0).each(function(p){const y=f(p);u.animator.setScore(this,0,y.score??NaN,u.formatter.formatScore(y.score,y.isDisqualified,R.SWISS,p.state),y.isDisqualified,R.SWISS)})},s=(o,c,f)=>{const u=this;return o.select(`.match-row__${c}-team-name`).each(function(p){const y=this.textContent??"",_=f(p),S=u.formatter.formatTeamName(_.name);y!==S&&u.animator.animateTeamNameUpdate(this,y,S,_.isDisqualified,R.SWISS)})},l=(o,c,f)=>{const u=this;return o.select(`.match-row__${c}-score`).each(function(p){const y=parseInt(this.textContent??""),_=f(p),S=_.score??NaN;y!==S&&!(isNaN(y)&&(isNaN(S)||_.isDisqualified))&&u.animator.animateScoreUpdate(this,y,S,u.formatter.formatScore(S,_.isDisqualified,R.SWISS,p.state),_.isDisqualified,R.SWISS)})};this.element.selectAll("div.match-row-wrapper").data(n.matches,o=>o.id).join(o=>o.append("div").classed("match-row-wrapper",!0).append("div").classed("match-row",!0).call(r,"top",c=>c.topTeam).call(c=>{c.append("div").classed("match-row__scores",!0).call(a,"top",f=>f.topTeam).call(a,"bottom",f=>f.bottomTeam)}).call(r,"bottom",c=>c.bottomTeam),o=>o.call(s,"top",c=>c.topTeam).call(l,"top",c=>c.topTeam).call(s,"bottom",c=>c.bottomTeam).call(l,"bottom",c=>c.bottomTeam));const h=this.getElement();i&&(this.scroller.initScrollMask(),this.animator.swissAnimator.beforeReveal(h,this),h.style.visibility="visible",await this.animator.swissAnimator.reveal(h,this)),this.scroller.start()}}g(Ue,"compatibleBracketTypes",[R.SWISS]);class tc{beforeHide(){}hide(){return Promise.resolve()}beforeReveal(){}async reveal(){return Promise.resolve()}}class ec{beforeHide(){}beforeReveal(){}hide(){return Promise.resolve()}reveal(){return Promise.resolve()}}const Bn="is-disqualified";class Pi{constructor(e,n,i){g(this,"eliminationAnimator"),g(this,"swissAnimator"),g(this,"roundRobinAnimator"),this.eliminationAnimator=e,this.swissAnimator=n,this.roundRobinAnimator=i}setDisqualifiedClass(e,n){n?e.classList.add(Bn):e.classList.remove(Bn)}}class nc{beforeHide(){}beforeReveal(){}hide(){return Promise.resolve()}reveal(){return Promise.resolve()}}class ic extends Pi{constructor(){super(new tc,new ec,new nc)}setScore(e,n,i,r,a){e.innerText=r,this.setDisqualifiedClass(e,a)}animateScoreUpdate(e,n,i,r,a){e.innerText=r,this.setDisqualifiedClass(e,a)}setTeamName(e,n,i,r){e.innerText=i,this.setDisqualifiedClass(e,r)}animateTeamNameUpdate(e,n,i,r){e.innerText=i,this.setDisqualifiedClass(e,r)}}class rc{formatScore(e,n,i,r){return n?"DQ":e==null||isNaN(e)?r===rt.COMPLETED||r===rt.IN_PROGRESS?"0":i===R.ROUND_ROBIN?"?":"-":String(e)}formatTeamName(e){return e??"-"}formatEliminationRoundNumber(e,n,i,r,a){if(a===R.SINGLE_ELIMINATION||i){if(e===n)return"Finals";if(e===n-1)return"Semi-Finals"}else if(a===R.DOUBLE_ELIMINATION){const s=r?e:e-1;if(s===n)return"Bracket Reset";if(s===n-1)return"Grand Finals";if(s===n-2)return"Finals";if(s===n-3)return"Semi-Finals"}return`Round ${e}`}}class qi{constructor(){g(this,"element"),g(this,"textElement"),this.element=yt("div").classed("dummy-renderer",!0),this.textElement=document.createElement("div"),this.element.append(()=>this.textElement)}async setData(e){return this.element.transition("fade-out").duration(350).ease(V).style("opacity","0").on("end",()=>{this.textElement.innerText=`Dummy renderer for bracket type ${e.type}`}).transition().duration(350).ease(V).style("opacity","1").end()}hide(){return this.element.transition("fade-out").duration(350).ease(V).style("opacity","0").end()}install(e){e.appendChild(this.getElement())}destroy(){this.element.remove()}getElement(){return this.element.node()}}g(qi,"compatibleBracketTypes",[]);var Ft=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function ac(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function sc(){this.__data__=[],this.size=0}var oc=sc;function lc(t,e){return t===e||t!==t&&e!==e}var Gi=lc,cc=Gi;function hc(t,e){for(var n=t.length;n--;)if(cc(t[n][0],e))return n;return-1}var de=hc,uc=de,fc=Array.prototype,dc=fc.splice;function pc(t){var e=this.__data__,n=uc(e,t);if(n<0)return!1;var i=e.length-1;return n==i?e.pop():dc.call(e,n,1),--this.size,!0}var mc=pc,gc=de;function yc(t){var e=this.__data__,n=gc(e,t);return n<0?void 0:e[n][1]}var vc=yc,_c=de;function wc(t){return _c(this.__data__,t)>-1}var bc=wc,xc=de;function Sc(t,e){var n=this.__data__,i=xc(n,t);return i<0?(++this.size,n.push([t,e])):n[i][1]=e,this}var kc=Sc,Tc=oc,Nc=mc,Ec=vc,$c=bc,Ac=kc;function xt(t){var e=-1,n=t==null?0:t.length;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}xt.prototype.clear=Tc;xt.prototype.delete=Nc;xt.prototype.get=Ec;xt.prototype.has=$c;xt.prototype.set=Ac;var pe=xt,Rc=pe;function Mc(){this.__data__=new Rc,this.size=0}var Cc=Mc;function Oc(t){var e=this.__data__,n=e.delete(t);return this.size=e.size,n}var zc=Oc;function Ic(t){return this.__data__.get(t)}var Hc=Ic;function Dc(t){return this.__data__.has(t)}var Bc=Dc,Lc=typeof Ft=="object"&&Ft&&Ft.Object===Object&&Ft,Ui=Lc,Wc=Ui,Pc=typeof self=="object"&&self&&self.Object===Object&&self,qc=Wc||Pc||Function("return this")(),ot=qc,Gc=ot,Uc=Gc.Symbol,me=Uc,Ln=me,ji=Object.prototype,jc=ji.hasOwnProperty,Fc=ji.toString,Rt=Ln?Ln.toStringTag:void 0;function Xc(t){var e=jc.call(t,Rt),n=t[Rt];try{t[Rt]=void 0;var i=!0}catch{}var r=Fc.call(t);return i&&(e?t[Rt]=n:delete t[Rt]),r}var Vc=Xc,Yc=Object.prototype,Zc=Yc.toString;function Kc(t){return Zc.call(t)}var Qc=Kc,Wn=me,Jc=Vc,th=Qc,eh="[object Null]",nh="[object Undefined]",Pn=Wn?Wn.toStringTag:void 0;function ih(t){return t==null?t===void 0?nh:eh:Pn&&Pn in Object(t)?Jc(t):th(t)}var Wt=ih;function rh(t){var e=typeof t;return t!=null&&(e=="object"||e=="function")}var ln=rh,ah=Wt,sh=ln,oh="[object AsyncFunction]",lh="[object Function]",ch="[object GeneratorFunction]",hh="[object Proxy]";function uh(t){if(!sh(t))return!1;var e=ah(t);return e==lh||e==ch||e==oh||e==hh}var Fi=uh,fh=ot,dh=fh["__core-js_shared__"],ph=dh,Ee=ph,qn=function(){var t=/[^.]+$/.exec(Ee&&Ee.keys&&Ee.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}();function mh(t){return!!qn&&qn in t}var gh=mh,yh=Function.prototype,vh=yh.toString;function _h(t){if(t!=null){try{return vh.call(t)}catch{}try{return t+""}catch{}}return""}var Xi=_h,wh=Fi,bh=gh,xh=ln,Sh=Xi,kh=/[\\^$.*+?()[\]{}|]/g,Th=/^\[object .+?Constructor\]$/,Nh=Function.prototype,Eh=Object.prototype,$h=Nh.toString,Ah=Eh.hasOwnProperty,Rh=RegExp("^"+$h.call(Ah).replace(kh,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function Mh(t){if(!xh(t)||bh(t))return!1;var e=wh(t)?Rh:Th;return e.test(Sh(t))}var Ch=Mh;function Oh(t,e){return t==null?void 0:t[e]}var zh=Oh,Ih=Ch,Hh=zh;function Dh(t,e){var n=Hh(t,e);return Ih(n)?n:void 0}var St=Dh,Bh=St,Lh=ot,Wh=Bh(Lh,"Map"),cn=Wh,Ph=St,qh=Ph(Object,"create"),ge=qh,Gn=ge;function Gh(){this.__data__=Gn?Gn(null):{},this.size=0}var Uh=Gh;function jh(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}var Fh=jh,Xh=ge,Vh="__lodash_hash_undefined__",Yh=Object.prototype,Zh=Yh.hasOwnProperty;function Kh(t){var e=this.__data__;if(Xh){var n=e[t];return n===Vh?void 0:n}return Zh.call(e,t)?e[t]:void 0}var Qh=Kh,Jh=ge,tu=Object.prototype,eu=tu.hasOwnProperty;function nu(t){var e=this.__data__;return Jh?e[t]!==void 0:eu.call(e,t)}var iu=nu,ru=ge,au="__lodash_hash_undefined__";function su(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=ru&&e===void 0?au:e,this}var ou=su,lu=Uh,cu=Fh,hu=Qh,uu=iu,fu=ou;function kt(t){var e=-1,n=t==null?0:t.length;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}kt.prototype.clear=lu;kt.prototype.delete=cu;kt.prototype.get=hu;kt.prototype.has=uu;kt.prototype.set=fu;var du=kt,Un=du,pu=pe,mu=cn;function gu(){this.size=0,this.__data__={hash:new Un,map:new(mu||pu),string:new Un}}var yu=gu;function vu(t){var e=typeof t;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?t!=="__proto__":t===null}var _u=vu,wu=_u;function bu(t,e){var n=t.__data__;return wu(e)?n[typeof e=="string"?"string":"hash"]:n.map}var ye=bu,xu=ye;function Su(t){var e=xu(this,t).delete(t);return this.size-=e?1:0,e}var ku=Su,Tu=ye;function Nu(t){return Tu(this,t).get(t)}var Eu=Nu,$u=ye;function Au(t){return $u(this,t).has(t)}var Ru=Au,Mu=ye;function Cu(t,e){var n=Mu(this,t),i=n.size;return n.set(t,e),this.size+=n.size==i?0:1,this}var Ou=Cu,zu=yu,Iu=ku,Hu=Eu,Du=Ru,Bu=Ou;function Tt(t){var e=-1,n=t==null?0:t.length;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}Tt.prototype.clear=zu;Tt.prototype.delete=Iu;Tt.prototype.get=Hu;Tt.prototype.has=Du;Tt.prototype.set=Bu;var hn=Tt,Lu=pe,Wu=cn,Pu=hn,qu=200;function Gu(t,e){var n=this.__data__;if(n instanceof Lu){var i=n.__data__;if(!Wu||i.length<qu-1)return i.push([t,e]),this.size=++n.size,this;n=this.__data__=new Pu(i)}return n.set(t,e),this.size=n.size,this}var Uu=Gu,ju=pe,Fu=Cc,Xu=zc,Vu=Hc,Yu=Bc,Zu=Uu;function Nt(t){var e=this.__data__=new ju(t);this.size=e.size}Nt.prototype.clear=Fu;Nt.prototype.delete=Xu;Nt.prototype.get=Vu;Nt.prototype.has=Yu;Nt.prototype.set=Zu;var Vi=Nt,Ku="__lodash_hash_undefined__";function Qu(t){return this.__data__.set(t,Ku),this}var Ju=Qu;function tf(t){return this.__data__.has(t)}var ef=tf,nf=hn,rf=Ju,af=ef;function se(t){var e=-1,n=t==null?0:t.length;for(this.__data__=new nf;++e<n;)this.add(t[e])}se.prototype.add=se.prototype.push=rf;se.prototype.has=af;var Yi=se;function sf(t,e){for(var n=-1,i=t==null?0:t.length;++n<i;)if(e(t[n],n,t))return!0;return!1}var of=sf;function lf(t,e){return t.has(e)}var Zi=lf,cf=Yi,hf=of,uf=Zi,ff=1,df=2;function pf(t,e,n,i,r,a){var s=n&ff,l=t.length,h=e.length;if(l!=h&&!(s&&h>l))return!1;var o=a.get(t),c=a.get(e);if(o&&c)return o==e&&c==t;var f=-1,u=!0,p=n&df?new cf:void 0;for(a.set(t,e),a.set(e,t);++f<l;){var y=t[f],_=e[f];if(i)var S=s?i(_,y,f,e,t,a):i(y,_,f,t,e,a);if(S!==void 0){if(S)continue;u=!1;break}if(p){if(!hf(e,function(v,k){if(!uf(p,k)&&(y===v||r(y,v,n,i,a)))return p.push(k)})){u=!1;break}}else if(!(y===_||r(y,_,n,i,a))){u=!1;break}}return a.delete(t),a.delete(e),u}var Ki=pf,mf=ot,gf=mf.Uint8Array,yf=gf;function vf(t){var e=-1,n=Array(t.size);return t.forEach(function(i,r){n[++e]=[r,i]}),n}var _f=vf;function wf(t){var e=-1,n=Array(t.size);return t.forEach(function(i){n[++e]=i}),n}var un=wf,jn=me,Fn=yf,bf=Gi,xf=Ki,Sf=_f,kf=un,Tf=1,Nf=2,Ef="[object Boolean]",$f="[object Date]",Af="[object Error]",Rf="[object Map]",Mf="[object Number]",Cf="[object RegExp]",Of="[object Set]",zf="[object String]",If="[object Symbol]",Hf="[object ArrayBuffer]",Df="[object DataView]",Xn=jn?jn.prototype:void 0,$e=Xn?Xn.valueOf:void 0;function Bf(t,e,n,i,r,a,s){switch(n){case Df:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case Hf:return!(t.byteLength!=e.byteLength||!a(new Fn(t),new Fn(e)));case Ef:case $f:case Mf:return bf(+t,+e);case Af:return t.name==e.name&&t.message==e.message;case Cf:case zf:return t==e+"";case Rf:var l=Sf;case Of:var h=i&Tf;if(l||(l=kf),t.size!=e.size&&!h)return!1;var o=s.get(t);if(o)return o==e;i|=Nf,s.set(t,e);var c=xf(l(t),l(e),i,r,a,s);return s.delete(t),c;case If:if($e)return $e.call(t)==$e.call(e)}return!1}var Lf=Bf;function Wf(t,e){for(var n=-1,i=e.length,r=t.length;++n<i;)t[r+n]=e[n];return t}var Pf=Wf,qf=Array.isArray,ct=qf,Gf=Pf,Uf=ct;function jf(t,e,n){var i=e(t);return Uf(t)?i:Gf(i,n(t))}var Ff=jf;function Xf(t,e){for(var n=-1,i=t==null?0:t.length,r=0,a=[];++n<i;){var s=t[n];e(s,n,t)&&(a[r++]=s)}return a}var Vf=Xf;function Yf(){return[]}var Zf=Yf,Kf=Vf,Qf=Zf,Jf=Object.prototype,td=Jf.propertyIsEnumerable,Vn=Object.getOwnPropertySymbols,ed=Vn?function(t){return t==null?[]:(t=Object(t),Kf(Vn(t),function(e){return td.call(t,e)}))}:Qf,nd=ed;function id(t,e){for(var n=-1,i=Array(t);++n<t;)i[n]=e(n);return i}var rd=id;function ad(t){return t!=null&&typeof t=="object"}var Pt=ad,sd=Wt,od=Pt,ld="[object Arguments]";function cd(t){return od(t)&&sd(t)==ld}var hd=cd,Yn=hd,ud=Pt,Qi=Object.prototype,fd=Qi.hasOwnProperty,dd=Qi.propertyIsEnumerable,pd=Yn(function(){return arguments}())?Yn:function(t){return ud(t)&&fd.call(t,"callee")&&!dd.call(t,"callee")},Ji=pd,oe={exports:{}};function md(){return!1}var gd=md;oe.exports;(function(t,e){var n=ot,i=gd,r=e&&!e.nodeType&&e,a=r&&!0&&t&&!t.nodeType&&t,s=a&&a.exports===r,l=s?n.Buffer:void 0,h=l?l.isBuffer:void 0,o=h||i;t.exports=o})(oe,oe.exports);var tr=oe.exports,yd=9007199254740991,vd=/^(?:0|[1-9]\d*)$/;function _d(t,e){var n=typeof t;return e=e??yd,!!e&&(n=="number"||n!="symbol"&&vd.test(t))&&t>-1&&t%1==0&&t<e}var er=_d,wd=9007199254740991;function bd(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=wd}var fn=bd,xd=Wt,Sd=fn,kd=Pt,Td="[object Arguments]",Nd="[object Array]",Ed="[object Boolean]",$d="[object Date]",Ad="[object Error]",Rd="[object Function]",Md="[object Map]",Cd="[object Number]",Od="[object Object]",zd="[object RegExp]",Id="[object Set]",Hd="[object String]",Dd="[object WeakMap]",Bd="[object ArrayBuffer]",Ld="[object DataView]",Wd="[object Float32Array]",Pd="[object Float64Array]",qd="[object Int8Array]",Gd="[object Int16Array]",Ud="[object Int32Array]",jd="[object Uint8Array]",Fd="[object Uint8ClampedArray]",Xd="[object Uint16Array]",Vd="[object Uint32Array]",z={};z[Wd]=z[Pd]=z[qd]=z[Gd]=z[Ud]=z[jd]=z[Fd]=z[Xd]=z[Vd]=!0;z[Td]=z[Nd]=z[Bd]=z[Ed]=z[Ld]=z[$d]=z[Ad]=z[Rd]=z[Md]=z[Cd]=z[Od]=z[zd]=z[Id]=z[Hd]=z[Dd]=!1;function Yd(t){return kd(t)&&Sd(t.length)&&!!z[xd(t)]}var Zd=Yd;function Kd(t){return function(e){return t(e)}}var Qd=Kd,le={exports:{}};le.exports;(function(t,e){var n=Ui,i=e&&!e.nodeType&&e,r=i&&!0&&t&&!t.nodeType&&t,a=r&&r.exports===i,s=a&&n.process,l=function(){try{var h=r&&r.require&&r.require("util").types;return h||s&&s.binding&&s.binding("util")}catch{}}();t.exports=l})(le,le.exports);var Jd=le.exports,tp=Zd,ep=Qd,Zn=Jd,Kn=Zn&&Zn.isTypedArray,np=Kn?ep(Kn):tp,nr=np,ip=rd,rp=Ji,ap=ct,sp=tr,op=er,lp=nr,cp=Object.prototype,hp=cp.hasOwnProperty;function up(t,e){var n=ap(t),i=!n&&rp(t),r=!n&&!i&&sp(t),a=!n&&!i&&!r&&lp(t),s=n||i||r||a,l=s?ip(t.length,String):[],h=l.length;for(var o in t)(e||hp.call(t,o))&&!(s&&(o=="length"||r&&(o=="offset"||o=="parent")||a&&(o=="buffer"||o=="byteLength"||o=="byteOffset")||op(o,h)))&&l.push(o);return l}var fp=up,dp=Object.prototype;function pp(t){var e=t&&t.constructor,n=typeof e=="function"&&e.prototype||dp;return t===n}var mp=pp;function gp(t,e){return function(n){return t(e(n))}}var yp=gp,vp=yp,_p=vp(Object.keys,Object),wp=_p,bp=mp,xp=wp,Sp=Object.prototype,kp=Sp.hasOwnProperty;function Tp(t){if(!bp(t))return xp(t);var e=[];for(var n in Object(t))kp.call(t,n)&&n!="constructor"&&e.push(n);return e}var Np=Tp,Ep=Fi,$p=fn;function Ap(t){return t!=null&&$p(t.length)&&!Ep(t)}var Rp=Ap,Mp=fp,Cp=Np,Op=Rp;function zp(t){return Op(t)?Mp(t):Cp(t)}var ir=zp,Ip=Ff,Hp=nd,Dp=ir;function Bp(t){return Ip(t,Dp,Hp)}var Lp=Bp,Qn=Lp,Wp=1,Pp=Object.prototype,qp=Pp.hasOwnProperty;function Gp(t,e,n,i,r,a){var s=n&Wp,l=Qn(t),h=l.length,o=Qn(e),c=o.length;if(h!=c&&!s)return!1;for(var f=h;f--;){var u=l[f];if(!(s?u in e:qp.call(e,u)))return!1}var p=a.get(t),y=a.get(e);if(p&&y)return p==e&&y==t;var _=!0;a.set(t,e),a.set(e,t);for(var S=s;++f<h;){u=l[f];var v=t[u],k=e[u];if(i)var O=s?i(k,v,u,e,t,a):i(v,k,u,t,e,a);if(!(O===void 0?v===k||r(v,k,n,i,a):O)){_=!1;break}S||(S=u=="constructor")}if(_&&!S){var M=t.constructor,D=e.constructor;M!=D&&"constructor"in t&&"constructor"in e&&!(typeof M=="function"&&M instanceof M&&typeof D=="function"&&D instanceof D)&&(_=!1)}return a.delete(t),a.delete(e),_}var Up=Gp,jp=St,Fp=ot,Xp=jp(Fp,"DataView"),Vp=Xp,Yp=St,Zp=ot,Kp=Yp(Zp,"Promise"),Qp=Kp,Jp=St,t0=ot,e0=Jp(t0,"Set"),rr=e0,n0=St,i0=ot,r0=n0(i0,"WeakMap"),a0=r0,je=Vp,Fe=cn,Xe=Qp,Ve=rr,Ye=a0,ar=Wt,Et=Xi,Jn="[object Map]",s0="[object Object]",ti="[object Promise]",ei="[object Set]",ni="[object WeakMap]",ii="[object DataView]",o0=Et(je),l0=Et(Fe),c0=Et(Xe),h0=Et(Ve),u0=Et(Ye),dt=ar;(je&&dt(new je(new ArrayBuffer(1)))!=ii||Fe&&dt(new Fe)!=Jn||Xe&&dt(Xe.resolve())!=ti||Ve&&dt(new Ve)!=ei||Ye&&dt(new Ye)!=ni)&&(dt=function(t){var e=ar(t),n=e==s0?t.constructor:void 0,i=n?Et(n):"";if(i)switch(i){case o0:return ii;case l0:return Jn;case c0:return ti;case h0:return ei;case u0:return ni}return e});var f0=dt,Ae=Vi,d0=Ki,p0=Lf,m0=Up,ri=f0,ai=ct,si=tr,g0=nr,y0=1,oi="[object Arguments]",li="[object Array]",Xt="[object Object]",v0=Object.prototype,ci=v0.hasOwnProperty;function _0(t,e,n,i,r,a){var s=ai(t),l=ai(e),h=s?li:ri(t),o=l?li:ri(e);h=h==oi?Xt:h,o=o==oi?Xt:o;var c=h==Xt,f=o==Xt,u=h==o;if(u&&si(t)){if(!si(e))return!1;s=!0,c=!1}if(u&&!c)return a||(a=new Ae),s||g0(t)?d0(t,e,n,i,r,a):p0(t,e,h,n,i,r,a);if(!(n&y0)){var p=c&&ci.call(t,"__wrapped__"),y=f&&ci.call(e,"__wrapped__");if(p||y){var _=p?t.value():t,S=y?e.value():e;return a||(a=new Ae),r(_,S,n,i,a)}}return u?(a||(a=new Ae),m0(t,e,n,i,r,a)):!1}var w0=_0,b0=w0,hi=Pt;function sr(t,e,n,i,r){return t===e?!0:t==null||e==null||!hi(t)&&!hi(e)?t!==t&&e!==e:b0(t,e,n,i,sr,r)}var or=sr,x0=Vi,S0=or,k0=1,T0=2;function N0(t,e,n,i){var r=n.length,a=r,s=!i;if(t==null)return!a;for(t=Object(t);r--;){var l=n[r];if(s&&l[2]?l[1]!==t[l[0]]:!(l[0]in t))return!1}for(;++r<a;){l=n[r];var h=l[0],o=t[h],c=l[1];if(s&&l[2]){if(o===void 0&&!(h in t))return!1}else{var f=new x0;if(i)var u=i(o,c,h,t,e,f);if(!(u===void 0?S0(c,o,k0|T0,i,f):u))return!1}}return!0}var E0=N0,$0=ln;function A0(t){return t===t&&!$0(t)}var lr=A0,R0=lr,M0=ir;function C0(t){for(var e=M0(t),n=e.length;n--;){var i=e[n],r=t[i];e[n]=[i,r,R0(r)]}return e}var O0=C0;function z0(t,e){return function(n){return n==null?!1:n[t]===e&&(e!==void 0||t in Object(n))}}var cr=z0,I0=E0,H0=O0,D0=cr;function B0(t){var e=H0(t);return e.length==1&&e[0][2]?D0(e[0][0],e[0][1]):function(n){return n===t||I0(n,t,e)}}var L0=B0,W0=Wt,P0=Pt,q0="[object Symbol]";function G0(t){return typeof t=="symbol"||P0(t)&&W0(t)==q0}var dn=G0,U0=ct,j0=dn,F0=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,X0=/^\w*$/;function V0(t,e){if(U0(t))return!1;var n=typeof t;return n=="number"||n=="symbol"||n=="boolean"||t==null||j0(t)?!0:X0.test(t)||!F0.test(t)||e!=null&&t in Object(e)}var pn=V0,hr=hn,Y0="Expected a function";function mn(t,e){if(typeof t!="function"||e!=null&&typeof e!="function")throw new TypeError(Y0);var n=function(){var i=arguments,r=e?e.apply(this,i):i[0],a=n.cache;if(a.has(r))return a.get(r);var s=t.apply(this,i);return n.cache=a.set(r,s)||a,s};return n.cache=new(mn.Cache||hr),n}mn.Cache=hr;var Z0=mn,K0=Z0,Q0=500;function J0(t){var e=K0(t,function(i){return n.size===Q0&&n.clear(),i}),n=e.cache;return e}var tm=J0,em=tm,nm=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,im=/\\(\\)?/g,rm=em(function(t){var e=[];return t.charCodeAt(0)===46&&e.push(""),t.replace(nm,function(n,i,r,a){e.push(r?a.replace(im,"$1"):i||n)}),e}),am=rm;function sm(t,e){for(var n=-1,i=t==null?0:t.length,r=Array(i);++n<i;)r[n]=e(t[n],n,t);return r}var om=sm,ui=me,lm=om,cm=ct,hm=dn,um=1/0,fi=ui?ui.prototype:void 0,di=fi?fi.toString:void 0;function ur(t){if(typeof t=="string")return t;if(cm(t))return lm(t,ur)+"";if(hm(t))return di?di.call(t):"";var e=t+"";return e=="0"&&1/t==-um?"-0":e}var fm=ur,dm=fm;function pm(t){return t==null?"":dm(t)}var mm=pm,gm=ct,ym=pn,vm=am,_m=mm;function wm(t,e){return gm(t)?t:ym(t,e)?[t]:vm(_m(t))}var fr=wm,bm=dn,xm=1/0;function Sm(t){if(typeof t=="string"||bm(t))return t;var e=t+"";return e=="0"&&1/t==-xm?"-0":e}var ve=Sm,km=fr,Tm=ve;function Nm(t,e){e=km(e,t);for(var n=0,i=e.length;t!=null&&n<i;)t=t[Tm(e[n++])];return n&&n==i?t:void 0}var dr=Nm,Em=dr;function $m(t,e,n){var i=t==null?void 0:Em(t,e);return i===void 0?n:i}var Am=$m;function Rm(t,e){return t!=null&&e in Object(t)}var Mm=Rm,Cm=fr,Om=Ji,zm=ct,Im=er,Hm=fn,Dm=ve;function Bm(t,e,n){e=Cm(e,t);for(var i=-1,r=e.length,a=!1;++i<r;){var s=Dm(e[i]);if(!(a=t!=null&&n(t,s)))break;t=t[s]}return a||++i!=r?a:(r=t==null?0:t.length,!!r&&Hm(r)&&Im(s,r)&&(zm(t)||Om(t)))}var Lm=Bm,Wm=Mm,Pm=Lm;function qm(t,e){return t!=null&&Pm(t,e,Wm)}var Gm=qm,Um=or,jm=Am,Fm=Gm,Xm=pn,Vm=lr,Ym=cr,Zm=ve,Km=1,Qm=2;function Jm(t,e){return Xm(t)&&Vm(e)?Ym(Zm(t),e):function(n){var i=jm(n,t);return i===void 0&&i===e?Fm(n,t):Um(e,i,Km|Qm)}}var tg=Jm;function eg(t){return t}var ng=eg;function ig(t){return function(e){return e==null?void 0:e[t]}}var rg=ig,ag=dr;function sg(t){return function(e){return ag(e,t)}}var og=sg,lg=rg,cg=og,hg=pn,ug=ve;function fg(t){return hg(t)?lg(ug(t)):cg(t)}var dg=fg,pg=L0,mg=tg,gg=ng,yg=ct,vg=dg;function _g(t){return typeof t=="function"?t:t==null?gg:typeof t=="object"?yg(t)?mg(t[0],t[1]):pg(t):vg(t)}var wg=_g;function bg(t,e,n,i){for(var r=t.length,a=n+(i?1:-1);i?a--:++a<r;)if(e(t[a],a,t))return a;return-1}var xg=bg;function Sg(t){return t!==t}var kg=Sg;function Tg(t,e,n){for(var i=n-1,r=t.length;++i<r;)if(t[i]===e)return i;return-1}var Ng=Tg,Eg=xg,$g=kg,Ag=Ng;function Rg(t,e,n){return e===e?Ag(t,e,n):Eg(t,$g,n)}var Mg=Rg,Cg=Mg;function Og(t,e){var n=t==null?0:t.length;return!!n&&Cg(t,e,0)>-1}var zg=Og;function Ig(t,e,n){for(var i=-1,r=t==null?0:t.length;++i<r;)if(n(e,t[i]))return!0;return!1}var Hg=Ig;function Dg(){}var Bg=Dg,Re=rr,Lg=Bg,Wg=un,Pg=1/0,qg=Re&&1/Wg(new Re([,-0]))[1]==Pg?function(t){return new Re(t)}:Lg,Gg=qg,Ug=Yi,jg=zg,Fg=Hg,Xg=Zi,Vg=Gg,Yg=un,Zg=200;function Kg(t,e,n){var i=-1,r=jg,a=t.length,s=!0,l=[],h=l;if(n)s=!1,r=Fg;else if(a>=Zg){var o=e?null:Vg(t);if(o)return Yg(o);s=!1,r=Xg,h=new Ug}else h=e?[]:l;t:for(;++i<a;){var c=t[i],f=e?e(c):c;if(c=n||c!==0?c:0,s&&f===f){for(var u=h.length;u--;)if(h[u]===f)continue t;e&&h.push(f),l.push(c)}else r(h,f,n)||(h!==l&&h.push(f),l.push(c))}return l}var Qg=Kg,Jg=wg,ty=Qg;function ey(t,e){return t&&t.length?ty(t,Jg(e)):[]}var ny=ey;const iy=ac(ny);class Ze extends fe{constructor(e){super(),g(this,"wrapper"),g(this,"gridElement"),g(this,"formatter"),g(this,"animator"),g(this,"rowHeight"),g(this,"rowWidth"),g(this,"rowGap"),g(this,"columnGap"),g(this,"activeBracketId"),g(this,"activeGridSize"),g(this,"zoomer"),this.formatter=e.formatter,this.animator=e.animator,this.activeBracketId=null,this.rowHeight=e.rowHeight??45,this.rowWidth=e.rowWidth??125,this.rowGap=e.rowGap??4,this.columnGap=e.columnGap??4,this.wrapper=yt("div").classed("round-robin-renderer__wrapper",!0),this.gridElement=this.wrapper.append("div").classed("round-robin-renderer",!0).style("column-gap",`${this.columnGap}px`).style("row-gap",`${this.rowGap}px`),this.zoomer=new ae(this.wrapper,this.onZoom.bind(this),e.maxScale??1.5)}onZoom(e){this.gridElement.style("transform",ae.toCSSTransform(e))}destroy(){this.zoomer.disconnect(),this.wrapper.remove()}getElement(){return this.wrapper.node()}async hide(){if(this.activeBracketId!=null){const e=this.getElement();this.animator.roundRobinAnimator.beforeHide(e,this),await this.animator.roundRobinAnimator.hide(e,this),e.style.visibility="hidden"}}install(e){e.appendChild(this.getElement()),this.zoomer.recalculateContainerSize()}async setData(e){const n=this.getElement();if(n.style.visibility="visible",e.matchGroups.length!==1)throw new Error(`Cannot render more (or less) than one match group at once! (Found ${e.matchGroups.length})`);const i=e.matchGroups[0],r=iy(i.matches.flatMap(o=>[o.bottomTeam,o.topTeam]).filter(o=>o.id!=null&&o.name!=null),o=>o.id),a=r.length+1,s=this.activeGridSize!==a||this.activeBracketId!==i.id;this.activeBracketId=i.id,this.activeGridSize=a,s&&(await this.hide(),this.gridElement.selectChildren().remove()),this.gridElement.style("grid-template-rows",`repeat(${a}, ${this.rowHeight}px)`).style("grid-template-columns",`repeat(${a}, ${this.rowWidth}px)`),this.zoomer.setContentSize(this.rowWidth*a+(this.columnGap*a-this.columnGap),this.rowHeight*a+(this.rowGap*a-this.rowGap));const l=[];for(let o=0;o<a;o++)for(let c=0;c<a;c++)if(o===0&&c===0)l.push({type:"blank",style:"blank",x:c,y:o});else if(o===0){const f=r[c-1];l.push({type:"teamName",side:"top",name:this.formatter.formatTeamName(f.name),isDisqualified:f.isDisqualified})}else if(c===0){const f=r[o-1];l.push({type:"teamName",side:"left",name:this.formatter.formatTeamName(f.name),isDisqualified:f.isDisqualified})}else if(o===c)l.push({x:c,y:o,type:"blank",style:"no-match"});else{const f=r[o-1],u=r[c-1],p=i.matches.find(v=>(v.topTeam.id===f.id||v.bottomTeam.id===f.id)&&(v.topTeam.id===u.id||v.bottomTeam.id===u.id)),y=f.id===(p==null?void 0:p.bottomTeam.id),_=y?p==null?void 0:p.bottomTeam:p==null?void 0:p.topTeam,S=y?p==null?void 0:p.topTeam:p==null?void 0:p.bottomTeam;l.push({type:"match",x:c,y:o,match:p,leftTeam:_,topTeam:S,leftTeamScore:this.formatter.formatScore(_==null?void 0:_.score,(_==null?void 0:_.isDisqualified)??!1,R.ROUND_ROBIN,(p==null?void 0:p.state)??rt.UNKNOWN),topTeamScore:this.formatter.formatScore(S==null?void 0:S.score,(S==null?void 0:S.isDisqualified)??!1,R.ROUND_ROBIN,(p==null?void 0:p.state)??rt.UNKNOWN)})}const h=this;if(this.gridElement.selectAll("div.round-robin-grid-item").data(l).join(o=>o.append("div").classed("round-robin-grid-item",!0).each(function(c){c.type==="blank"?this.classList.add("type-blank",`type-blank-${c.style}`):c.type==="teamName"?(this.classList.add("type-team-name",`type-team-name-${c.side}`),h.animator.setTeamName(this,"",c.name,c.isDisqualified,R.ROUND_ROBIN)):this.classList.add(`type-${c.type}`),c.type==="match"&&(this.dataset.xPosition=c.x.toString(),this.dataset.yPosition=c.y.toString(),h.insertScoreLayout(this,c),h.setWinnerClasses(this,c))}),o=>o.each(function(c){if(h.setWinnerClasses(this,c),c.type==="match")h.updateScore(this,c);else if(c.type==="teamName"){const f=this.innerText;f!==c.name&&h.animator.animateTeamNameUpdate(this,f,c.name,c.isDisqualified,R.ROUND_ROBIN)}})),s){const o=this.getElement();this.animator.roundRobinAnimator.beforeReveal(o,this),o.style.visibility="visible",await this.animator.roundRobinAnimator.reveal(o,this)}}setWinnerClasses(e,n){var i,r,a,s,l,h;n.type!=="match"||((i=n.match)==null?void 0:i.state)!==rt.IN_PROGRESS&&((r=n.match)==null?void 0:r.state)!==rt.COMPLETED?e.classList.remove("left-team-winner","top-team-winner","in-progress"):((a=n.match)==null?void 0:a.state)===rt.IN_PROGRESS?e.classList.add("in-progress"):((s=n.match)==null?void 0:s.state)===rt.COMPLETED&&((l=n.leftTeam)==null?void 0:l.score)!=null&&((h=n.topTeam)==null?void 0:h.score)!=null&&(e.classList.remove("in-progress"),n.leftTeam.score>n.topTeam.score?(e.classList.remove("top-team-winner"),e.classList.add("left-team-winner")):(e.classList.remove("left-team-winner"),e.classList.add("top-team-winner")))}updateScore(e,n){["left","top"].forEach(i=>{const r=e.querySelector(`.${i}-score-wrapper > .team-score`),a=parseInt(r.textContent??""),s=i==="left"?n.leftTeam:n.topTeam,l=(s==null?void 0:s.score)??NaN;a!==l&&!(isNaN(a)&&(isNaN(l)||s!=null&&s.isDisqualified))&&this.animator.animateScoreUpdate(r,a,l,i==="left"?n.leftTeamScore:n.topTeamScore,(s==null?void 0:s.isDisqualified)??!1,R.ROUND_ROBIN)})}insertScoreWrapper(e,n,i,r){const a=this.animator;e.append("div").classed("score-wrapper",!0).classed(`${i}-score-wrapper`,!0).append("div").classed("team-score",!0).each(function(s){a.setScore(this,0,(r==null?void 0:r.score)??NaN,n,(r==null?void 0:r.isDisqualified)??!1,R.ROUND_ROBIN)})}insertScoreLayout(e,n){H(e).append("div").classed("score-layout",!0).call(this.insertScoreWrapper.bind(this),n.leftTeamScore,"left",n.leftTeam).call(i=>{i.append("div").classed("score-separator",!0)}).call(this.insertScoreWrapper.bind(this),n.topTeamScore,"top",n.topTeam)}}g(Ze,"compatibleBracketTypes",[R.ROUND_ROBIN]);class ry{constructor(e){g(this,"activeRenderer"),g(this,"opts"),g(this,"element"),this.activeRenderer=null,this.opts={animator:(e==null?void 0:e.animator)??new ic,formatter:(e==null?void 0:e.formatter)??new rc,eliminationOpts:(e==null?void 0:e.eliminationOpts)??{},swissOpts:(e==null?void 0:e.swissOpts)??{},roundRobinOpts:(e==null?void 0:e.roundRobinOpts)??{}},this.element=yt("div").classed("bracket-renderer",!0).node()}async setData(e){var n,i;return(this.activeRenderer==null||!this.activeRenderer.constructor.compatibleBracketTypes.includes(e.type))&&(await((n=this.activeRenderer)==null?void 0:n.hide()),(i=this.activeRenderer)==null||i.destroy(),this.activeRenderer=this.getRenderer(e.type),this.activeRenderer.install(this.element)),this.activeRenderer.setData(e)}getRenderer(e){return Ue.compatibleBracketTypes.includes(e)?new Ue({animator:this.opts.animator,formatter:this.opts.formatter,...this.opts.swissOpts}):Ge.compatibleBracketTypes.includes(e)?new Ge({animator:this.opts.animator,formatter:this.opts.formatter,...this.opts.eliminationOpts}):Ze.compatibleBracketTypes.includes(e)?new Ze({animator:this.opts.animator,formatter:this.opts.formatter,...this.opts.roundRobinOpts}):new qi}}class ay{beforeHide(){}async hide(e){return H(e).transition().duration(350).ease(V).style("opacity","0").end()}beforeReveal(e){const n=H(e);n.style("opacity","1"),n.selectAll("div.match-cell").style("opacity","0").style("transform","translateX(-10px)"),n.selectAll(".round-label, .elimination-renderer__bracket-title").style("opacity","0"),n.selectAll(".bracket-link").style("stroke-dashoffset","-1")}async reveal(e,n){const i=H(e),r=n.getBracketDepth();await Promise.all([i.selectAll("div.match-cell").transition().duration(350).ease(We).style("opacity","1").style("transform","translateX(0px)").delay(a=>(r-a.depth)*200).end(),i.selectAll(".round-label, .elimination-renderer__bracket-title").transition().duration(350).ease(We).style("opacity","1").delay(a=>(a??0)*200).end(),i.selectAll(".bracket-link").transition().duration(750).ease(Bi).style("stroke-dashoffset","0").delay(a=>(r-a.source.depth)*300+100).end()])}}class sy{beforeHide(){}beforeReveal(e){H(e).style("opacity","1").selectAll("div.match-row").style("opacity","0")}async hide(e){return H(e).transition().duration(350).ease(V).style("opacity","0").end()}async reveal(e){return H(e).selectAll("div.match-row").transition().duration(350).ease(V).style("opacity","1").delay((n,i)=>i*50).end()}}class oy{beforeHide(){}hide(e){return H(e).transition().duration(350).ease(V).style("opacity","0").end()}beforeReveal(e){ys(".round-robin-grid-item").style("opacity","0"),e.style.opacity="1"}reveal(e){const n=H(e);return Promise.all([n.selectAll(".type-blank-blank, .type-team-name").transition().duration(350).ease(V).style("opacity","1").end(),n.selectAll(".type-match, .type-blank-no-match").transition().duration(350).ease(V).style("opacity","1").delay(i=>(i.y+i.x)*100).end()])}}class ly extends Pi{constructor(){super(new ay,new sy,new oy)}setScore(e,n,i,r,a){e.innerText=r,this.setDisqualifiedClass(e,a)}animateScoreUpdate(e,n,i,r,a,s){const l=s===R.SWISS||s===R.ROUND_ROBIN?"translateY":"translateX",h=l==="translateY"?e.getBoundingClientRect().height:e.getBoundingClientRect().width,o=isNaN(n)||n<i?-1:1,c=H(e),f=this;c.call(u=>u.transition().duration(250).ease(tl).style("transform",`${l}(${h*o}px)`).on("end",function(){H(this).text(r).style("transform",`${l}(${-h*o}px)`),f.setDisqualifiedClass(this,a)}).transition().ease(We).style("transform",`${l}(0px)`))}setTeamName(e,n,i,r){e.innerText=i,this.setDisqualifiedClass(e,r)}animateTeamNameUpdate(e,n,i,r){const a=H(e),s=this;a.call(l=>l.transition().duration(250).ease(V).style("opacity","0").on("end",function(){H(this).text(i),s.setDisqualifiedClass(this,r)}).transition().ease(V).style("opacity","1"))}}const cy=nodecg.Replicant("bracketData",mr),pr=gr("brackets",{state:()=>({bracketData:void 0})}),hy=yr([cy],pr),uy={class:"bracket-title-wrapper"},fy={class:"bracket-title-box"},dy=vr({__name:"BracketGraphic",setup(t){const e=_r(),n=pr(),i=wr(()=>{var l,h,o,c,f;let a=(l=n.bracketData)==null?void 0:l.name;const s=(o=(h=n.bracketData)==null?void 0:h.matchGroups[0])==null?void 0:o.name;return s!==a&&(a+=` - ${s}`),((c=n.bracketData)==null?void 0:c.roundNumber)!=null&&(a+=` - Round ${(f=n.bracketData)==null?void 0:f.roundNumber}`),a}),r=new ry({animator:new ly,swissOpts:{rowHeight:70},roundRobinOpts:{maxScale:1.75}});return br(async()=>{e.value.appendChild(r.element),await document.fonts.load("400 32px Splatoon2"),xr(()=>n.bracketData,a=>{a!=null&&r.setData(a)},{immediate:!0})}),(a,s)=>(gn(),Sr($r,null,[we("div",uy,[we("div",fy,[kr(zr,null,{default:yn(()=>[(gn(),Tr(Or,{key:i.value,"max-width":690,align:"center"},{default:yn(()=>[Nr(Er(i.value),1)]),_:1}))]),_:1})])]),we("div",{ref_key:"wrapper",ref:e,class:"bracket-wrapper"},null,512)],64))}});const py=Ar(dy,[["__scopeId","data-v-3deef8cd"]]);(async()=>{const t=Rr(py);Mr(t),t.use(Cr()),await hy(),t.mount("#app")})();
