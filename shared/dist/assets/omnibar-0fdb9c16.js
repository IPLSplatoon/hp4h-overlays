import{D as T,a as G,u as J,i as Q,c as X}from"./installCommonHelpers-49d8da94.js";import{r as C,y as q,w as W,h as N,i as A,d as g,j as m,_ as y,v as $,o as p,c as h,l as S,m as f,e as O,q as b,t as _,b as c,A as U,f as F,k as H,p as Z,a as ee,x as te,T as z,F as ne,z as oe,B as ae,g as se,s as ie}from"./storeHelper-9f994824.js";import{F as x,O as E,g as v}from"./FittedContent-324eb0dd.js";import{d as j}from"./index-1d0a63e5.js";import{u as K,i as ce}from"./activeRoundStore-773e9ebe.js";import{u as re,i as de}from"./donationDataStore-a7f65c14.js";import{_ as ue}from"./iconic-mark-d1a3d70a.js";import{i as le}from"./casterStore-891b8249.js";function L(e,t){return t+1===e.length?0:t+1}function V(e){return e.enabled==null||e.enabled.value}function me(e){const t=C(null),s=C(null),l=()=>{if(e.every(n=>!V(n)))t.value=0,s.value=e[t.value].component;else{t.value=t.value==null?0:L(e,t.value);let n=e[t.value];for(;!V(n);)t.value=L(e,t.value),n=e[t.value];s.value=n.component}};let u;const r=()=>{if(t.value!=null){const n=e[t.value];u=window.setTimeout(()=>{l(),r()},(n.duration??30)*1e3)}};let o=!1;const i=n=>{const d=e.findIndex(a=>a.component===n);if(d===-1){console.warn(`Could not find slide ${n}`);return}const w=e[d];clearTimeout(u),o=!0,t.value=d,s.value=w.component,r()};return l(),r(),q(()=>{clearTimeout(u)}),W(()=>{var n;return t.value==null?!0:(n=e[t.value].enabled)==null?void 0:n.value},n=>{n===!1&&!o?(clearTimeout(u),l(),r()):o=!1}),{activeComponent:s,forceSetSlide:i}}function pe(e){return[e==null?void 0:e.artist,e==null?void 0:e.song].filter(t=>!j.isBlank(t)).join(" - ")}const _e=nodecg.Replicant("nowPlaying",T),ve=nodecg.Replicant("musicShown",T),B=N("music",{state:()=>({nowPlaying:{},musicShown:null})}),fe=A([_e,ve],B),he=g({name:"OmnibarMusic",components:{FittedContent:x,OpacitySwapTransition:E},setup(){const e=B();return{nowPlaying:m(()=>pe(e.nowPlaying))}}});const Se={class:"lower-third-music"};function we(e,t,s,l,u,r){const o=$("fitted-content"),i=$("opacity-swap-transition");return p(),h("div",Se,[S(i,null,{default:f(()=>[(p(),O(o,{key:e.nowPlaying,"max-width":1200,align:"center"},{default:f(()=>[b(_(e.nowPlaying),1)]),_:1}))]),_:1})])}const be=y(he,[["render",we]]),$e=nodecg.Replicant("nextRound",T),k=N("nextRound",{state:()=>({nextRound:null})}),ge=A([$e],k),ye=g({name:"OmnibarNextRound",components:{FittedContent:x,OpacitySwapTransition:E},setup(){const e=k();return{teamA:m(()=>e.nextRound.teamA),teamB:m(()=>e.nextRound.teamB)}}});const Oe={class:"next-round-content-wrapper"},xe={class:"team-name"},Re=c("span",{class:"versus"},"vs",-1),De={class:"team-name"};function Ce(e,t,s,l,u,r){const o=$("fitted-content"),i=$("opacity-swap-transition");return p(),O(i,null,{default:f(()=>{var n,d;return[(p(),O(o,{key:`${(n=e.teamA)==null?void 0:n.name}_${(d=e.teamB)==null?void 0:d.name}`,"max-width":1200,align:"center"},{default:f(()=>{var w,a;return[c("div",Oe,[c("span",xe,_(e.$helpers.addDots((w=e.teamA)==null?void 0:w.name)),1),Re,c("span",De,_(e.$helpers.addDots((a=e.teamB)==null?void 0:a.name)),1)])]}),_:1}))]}),_:1})}const Te=y(ye,[["render",Ce]]),Ee=g({name:"OmnibarActiveRound",components:{FittedContent:x,OpacitySwapTransition:E},setup(){const e=K(),t=m(()=>e.activeRound.teamA),s=m(()=>e.activeRound.teamB);return{teamA:t,teamB:s}}});const Pe={class:"lower-third-active-round"},Ne={class:"team-name"},Ae={class:"scores"},Be={class:"team-name"};function ke(e,t,s,l,u,r){const o=$("fitted-content"),i=$("opacity-swap-transition");return p(),h("div",Pe,[S(i,null,{default:f(()=>{var n,d;return[(p(),O(o,{key:`${(n=e.teamA)==null?void 0:n.name}_${(d=e.teamB)==null?void 0:d.name}`,"max-width":1200,align:"center"},{default:f(()=>{var w,a,R,M;return[c("span",Ne,_(e.$helpers.addDots((w=e.teamA)==null?void 0:w.name)),1),c("span",Ae,_((a=e.teamA)==null?void 0:a.score)+" - "+_((R=e.teamB)==null?void 0:R.score),1),c("span",Be,_(e.$helpers.addDots((M=e.teamB)==null?void 0:M.name)),1)]}),_:1}))]}),_:1})])}const Ie=y(Ee,[["render",ke]]);function D(e){const t=C(U(e));return W(()=>U(e),s=>{v.to(t,{duration:.5,value:s,roundProps:{value:1},ease:"power2.inOut"})}),t}const Me=nodecg.Replicant("predictionStore",T),I=N("prediction",{state:()=>({predictionStore:null})}),Ue=A([Me],I),Fe=g({name:"OmnibarPredictions",components:{FittedContent:x},setup(){const e=I(),t=m(()=>{var a;return(a=e.predictionStore.currentPrediction)==null?void 0:a.outcomes[0]}),s=m(()=>{var a;return(a=e.predictionStore.currentPrediction)==null?void 0:a.outcomes[1]}),l=m(()=>{var a,R;return(((a=t.value)==null?void 0:a.pointsUsed)??0)+(((R=s.value)==null?void 0:R.pointsUsed)??0)});function u(a){return a===0||!a?0:Math.round(a/l.value*100)}const r=m(()=>{var a;return u((a=t.value)==null?void 0:a.pointsUsed)}),o=m(()=>{var a;return u((a=s.value)==null?void 0:a.pointsUsed)}),i=D(r),n=D(o),d=D(m(()=>{var a;return((a=t.value)==null?void 0:a.pointsUsed)??0})),w=D(m(()=>{var a;return((a=s.value)==null?void 0:a.pointsUsed)??0}));return{addDots:G,firstOutcome:t,secondOutcome:s,firstOutcomePercentage:r,secondOutcomePercentage:o,tweenedFirstOutcomePercentage:i,tweenedSecondOutcomePercentage:n,tweenedFirstOutcomePointsUsed:d,tweenedSecondOutcomePointsUsed:w,padNumber:j.padNumber}}});const Le={class:"lower-third-predictions"},Ve={class:"first-outcome"},qe={class:"subtext"},We={class:"total-points"},He={class:"percentage-text"},ze={class:"second-outcome"},je={class:"subtext"},Ke={class:"percentage-text"},Ye={class:"total-points"};function Ge(e,t,s,l,u,r){const o=$("fitted-content");return p(),h("div",Le,[c("div",Ve,[S(o,{"max-width":550,class:"team-name",align:"right"},{default:f(()=>{var i;return[b(_(e.addDots((i=e.firstOutcome)==null?void 0:i.title)),1)]}),_:1}),c("div",qe,[c("span",We,_(e.tweenedFirstOutcomePointsUsed)+"p",1),b(" / "),c("span",He,_(e.padNumber(e.tweenedFirstOutcomePercentage,2))+"%",1)]),c("div",{class:"percentage-bar",style:F({width:`${e.firstOutcomePercentage}%`})},null,4)]),c("div",ze,[S(o,{"max-width":550,class:"team-name"},{default:f(()=>{var i;return[b(_(e.addDots((i=e.secondOutcome)==null?void 0:i.title)),1)]}),_:1}),c("div",je,[c("span",Ke,_(e.padNumber(e.tweenedSecondOutcomePercentage,2))+"%",1),b(" / "),c("span",Ye,_(e.tweenedSecondOutcomePointsUsed)+"p",1)]),c("div",{class:"percentage-bar",style:F({width:`${e.secondOutcomePercentage}%`})},null,4)])])}const Je=y(Fe,[["render",Ge]]),Y=e=>(Z("data-v-d94f37cc"),e=e(),ee(),e),Qe={class:"event-info"},Xe={key:0},Ze=Y(()=>c("span",{class:"highlight"},"HP for Heroes",-1)),et={key:1,class:"location"},tt=Y(()=>c("span",{class:"highlight"},"!donate",-1)),nt=g({__name:"OmnibarEventIntro",setup(e){const t=C(!1);return H(()=>{setTimeout(()=>{t.value=!0},7500)}),(s,l)=>(p(),h("div",Qe,[S(E,{mode:"default"},{default:f(()=>[t.value?(p(),h("span",et,[b(" Support the cause - "),tt])):(p(),h("span",Xe,[b("You are watching "),Ze]))]),_:1})]))}});const ot=y(nt,[["__scopeId","data-v-d94f37cc"]]),P=400,at=g({__name:"OmnibarSlideTitle",props:{text:{}},setup(e){const t=e;let s=0;function l(o,i){if(t.text==null)s=0,v.to(o,{opacity:0,duration:.35,onComplete:i});else{const n=o.querySelector(".text-content");s=Math.min(n.querySelector("div").getBoundingClientRect().width,P),v.to(n,{opacity:0,duration:.35,onComplete:i})}}function u(o){s===0?v.set(o,{opacity:0}):(v.set(o,{width:s}),v.set(o.querySelector(".text-content"),{opacity:0}))}function r(o,i){const n=Math.min(o.querySelector(".text-content > div").getBoundingClientRect().width,P);s===0?(v.set(o,{width:n}),v.to(o,{opacity:1,duration:.35,onComplete:i})):(v.to(o,{duration:.5,ease:"power2.inOut",width:n}),v.to(o.querySelector(".text-content"),{opacity:1,duration:.35,delay:.35,onComplete:i}))}return(o,i)=>(p(),O(z,{css:!1,mode:"out-in",onLeave:l,onEnter:r,onBeforeEnter:u},{default:f(()=>[t.text!=null?(p(),h("div",{key:t.text,class:"omnibar-slide-title"},[S(x,{class:"text-content","max-width":P},{default:f(()=>[b(_(t.text),1)]),_:1})])):te("",!0)]),_:1}))}});const st=y(at,[["__scopeId","data-v-31d5ce8a"]]),it={class:"donation-total-wrapper"},ct=g({__name:"DonationTotal",props:{maxWidth:{}},setup(e){const t=e,s=re(),l=D(()=>s.donationData.donationTotal),u=m(()=>l.value.toLocaleString("en-US",{style:"currency",currency:s.donationData.currency,maximumFractionDigits:0})),r=C([]);function o(i){r.value.push({id:i.id,amount:i.amount.toLocaleString("en-US",{style:"currency",currency:s.donationData.currency,maximumFractionDigits:2})}),setTimeout(()=>{r.value=r.value.filter(n=>n.id!==i.id)},5e3)}return H(()=>{nodecg.listenFor("donationReceived",o)}),q(()=>{nodecg.unlisten("donationReceived",o)}),(i,n)=>(p(),h("div",it,[(p(!0),h(ne,null,oe(r.value,d=>(p(),h("div",{key:d.id,class:"new-donation"}," +"+_(d.amount),1))),128)),S(x,{"max-width":t.maxWidth,class:"donation-total",align:"center"},{default:f(()=>[b(_(u.value),1)]),_:1},8,["max-width"])]))}});const rt=y(ct,[["__scopeId","data-v-bbddca5e"]]),dt=g({name:"Omnibar",components:{DonationTotal:rt,OmnibarMusic:be,OmnibarNextRound:Te,OmnibarActiveRound:Ie,OmnibarPredictions:Je,OmnibarEventIntro:ot,OmnibarSlideTitle:st},setup(){const e=K(),t=k(),s=B(),l=I(),u=J(),r=m(()=>{var d;const n=l.predictionStore.currentPrediction;return((d=l.predictionStore.status)==null?void 0:d.predictionsEnabled)&&((n==null?void 0:n.status)==="ACTIVE"||(n==null?void 0:n.status)==="LOCKED")}),o=me([{component:"OmnibarEventIntro",duration:15},{component:"OmnibarMusic",enabled:m(()=>s.musicShown),duration:15},{component:"OmnibarNextRound",enabled:m(()=>t.nextRound.showOnStream)},{component:"OmnibarActiveRound",enabled:m(()=>{var n;return!t.nextRound.showOnStream&&(u.obsData.status!=="CONNECTED"||u.activeBreakScene!=="stages"||!(((n=u.obsData.currentScene)==null?void 0:n.toLowerCase().includes("roster"))??!1))})},{component:"OmnibarPredictions",enabled:r}]);return nodecg.listenFor("showPredictionData",T,()=>{o.forceSetSlide("OmnibarPredictions")}),{slideTitle:m(()=>{switch(o.activeComponent.value){case"OmnibarMusic":return"Music";case"OmnibarNextRound":return`Next: ${t.nextRound.name}`;case"OmnibarActiveRound":return`Now: ${e.activeRound.match.name}`;case"OmnibarPredictions":return"Predictions";default:return null}}),activeSlide:o.activeComponent,slideLeave(n,d){v.to(n,{y:15,opacity:0,ease:"power2.in",duration:.5,onComplete:d})},beforeSlideEnter(n){v.set(n,{y:-15,opacity:0})},slideEnter(n,d){v.to(n,{y:0,opacity:1,ease:"power2.out",duration:.5,onComplete:d})}}}});const ut={class:"omnibar-wrapper"},lt={class:"omnibar-content"},mt={class:"omnibar-logo-wrapper"},pt=c("img",{class:"tournament-logo",src:ue},null,-1),_t={class:"omnibar-slides"},vt={class:"slide-content"};function ft(e,t,s,l,u,r){const o=$("donation-total"),i=$("omnibar-slide-title");return p(),h("div",ut,[c("div",lt,[c("div",mt,[pt,S(o,{"max-width":135})]),c("div",_t,[S(i,{class:"slide-title",text:e.slideTitle},null,8,["text"]),c("div",vt,[S(z,{mode:"out-in",onLeave:e.slideLeave,onEnter:e.slideEnter,onBeforeEnter:e.beforeSlideEnter},{default:f(()=>[(p(),O(ae(e.activeSlide)))]),_:1},8,["onLeave","onEnter","onBeforeEnter"])])])])])}const ht=y(dt,[["render",ft]]);(async()=>{const e=se(ht);Q(e),e.use(ie()),await ce(),await le(),await fe(),await Ue(),await ge(),await X(),await de(),e.mount("#app")})();
