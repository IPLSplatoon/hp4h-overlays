import{i as E}from"./installCommonHelpers-6574289e.js";import{d as v,r as _,w as C,j as w,_ as h,v as k,o,c as l,l as u,m,f,x as I,k as B,y as z,b as c,n as b,e as g,t as y,q as $,F as R,z as x,g as W,s as T}from"./storeHelper-4fec82dd.js";import{u as V,i as j}from"./casterStore-e2757834.js";import{O as D,F as S,g as L}from"./FittedContent-d9f9a985.js";import{B as F}from"./Badge-59b52fe0.js";import{l as N}from"./imageHelper-ac1ce4f9.js";import{d as O}from"./index-d100c31e.js";const U=v({name:"ImageLoader",components:{OpacitySwapTransition:D},props:{src:{type:[String,null],default:null},defaultSrc:{type:[String,null],default:null}},setup(e){const a=_(!0),t=_(!1);return C(()=>e.src,async s=>{a.value=!0;try{t.value=await N(s)}catch(i){console.error(i),t.value=!1}finally{a.value=!1}},{immediate:!0}),{doesImageExist:t,imageVisible:w(()=>(t.value||!O.isBlank(e.defaultSrc))&&!a.value)}}});const A={class:"image-loader-wrapper"};function H(e,a,t,s,i,d){const r=k("opacity-swap-transition");return o(),l("div",A,[u(r,null,{default:m(()=>[e.imageVisible?(o(),l("div",{key:0,style:f({backgroundImage:`url('${e.doesImageExist?e.src:e.defaultSrc}')`}),class:"image-loader"},null,4)):I("",!0)]),_:1})])}const q=h(U,[["render",H]]),G={class:"video-loader-wrapper"},M=["src"],P=v({__name:"VideoLoader",props:{src:{}},setup(e){const a=e,t=_(null),s=_(!1),i=r=>{var n;r.source===((n=t.value)==null?void 0:n.contentWindow)&&r.data.action==="new-video-track-added"&&(s.value=!0)},d=()=>s.value=!0;return B(()=>{C(()=>a.src,r=>{var n,p;window.removeEventListener("message",i),(n=t.value)==null||n.removeEventListener("load",d),r!=null&&r.includes("vdo.ninja")?window.addEventListener("message",i):(p=t.value)==null||p.addEventListener("load",d)},{immediate:!0})}),z(()=>{window.removeEventListener("message",i)}),(r,n)=>(o(),l("div",G,[c("iframe",{ref_key:"iframe",ref:t,allow:"autoplay;camera;microphone;fullscreen;picture-in-picture;display-capture;midi;geolocation;",src:r.src,width:"1280",height:"720",class:b({loaded:s.value})},null,10,M)]))}});const J={class:"large-caster-wrapper"},K={class:"details"},Q=v({__name:"LargeCasterDisplay",props:{caster:{},width:{},aspectRatio:{}},setup(e){const a=e,t=w(()=>a.width*a.aspectRatio);return(s,i)=>(o(),l("div",J,[c("div",{class:"large-caster-display",style:f({width:`${a.width}px`})},[c("div",{class:"caster-visual",style:f({height:`${t.value}px`})},[s.$helpers.isBlank(s.caster.videoUrl)?(o(),g(q,{key:0,class:"caster-image",src:s.caster.imageUrl},null,8,["src"])):(o(),g(P,{key:1,src:s.caster.videoUrl,class:"caster-video"},null,8,["src"]))],4),c("div",K,[u(S,{"max-width":365,align:"left",class:"name-wrapper"},{default:m(()=>[c("span",null,y(a.caster.name),1),u(F,{class:"pronouns",color:s.$helpers.colors.accentRed},{default:m(()=>[$(y(a.caster.pronouns),1)]),_:1},8,["color"])]),_:1}),u(S,{"max-width":365,align:"left",class:"twitter-wrapper"},{default:m(()=>[$(y(a.caster.twitter),1)]),_:1})])],4)]))}});const X=h(Q,[["__scopeId","data-v-1c89f1df"]]);function Y(e){window.obsstudio!==void 0?(window.addEventListener("obsSourceActiveChanged",a=>{const t=e();a.detail.active?t.restart(!0):(t.pause(0),t.kill())}),window.addEventListener("obsSourceVisibleChanged",a=>{a.detail.visible&&e().restart(!1)})):(e().delay(1).restart(!0),document.body.ondblclick=()=>{e().delay(1).restart(!0)})}const Z=v({name:"Casters",components:{LargeCasterDisplay:X},setup(){const e=V();return Y(()=>{const a=L.timeline();return a.fromTo(".caster-display",{y:-250,rotate:L.utils.random(-5,5,.1,!0),opacity:0},{y:0,stagger:-.25,duration:.75,ease:"power2.out",rotate:0,opacity:1,delay:.5}),a}),{casterStore:e,casterSize:w(()=>{switch(Object.keys(e.casters).length){case 1:return{width:1e3,aspectRatio:9/16,wrapperWidth:1200};case 2:return{width:700,aspectRatio:9/12,wrapperWidth:1500};default:return{width:550,aspectRatio:9/10,wrapperWidth:1800}}})}}});const ee={class:"casters-wrapper"};function ae(e,a,t,s,i,d){const r=k("large-caster-display");return o(),l("div",ee,[c("div",{class:b(["casters-layout",`caster-count_${Object.keys(e.casterStore.casters).length}`]),style:f({width:`${e.casterSize.wrapperWidth}px`})},[(o(!0),l(R,null,x(e.casterStore.casters,(n,p)=>(o(),g(r,{key:`caster_${p}`,caster:n,class:"caster-display",width:e.casterSize.width,"aspect-ratio":e.casterSize.aspectRatio},null,8,["caster","width","aspect-ratio"]))),128))],6)])}const te=h(Z,[["render",ae],["__scopeId","data-v-a01191d3"]]);(async()=>{const e=W(te);E(e),e.use(T()),await j(),e.mount("#app")})();
